---
title: memory
sidebar_position: 1
---

<!-- Code generated by gomarkdoc. DO NOT EDIT -->


# memory

```go
import "github.com/lookatitude/beluga-ai/pkg/memory"
```

Package memory provides configuration management for memory implementations. It follows the framework's configuration patterns with struct tags for validation and functional options for runtime configuration.

Package memory provides custom error types for package\-specific errors. It follows the framework's error handling patterns with custom error types that preserve error chains and provide context about failed operations.

Package memory provides interfaces and implementations for managing conversation history. It follows the Beluga AI Framework design patterns with proper separation of concerns, configuration management, observability, and error handling.

The package supports multiple memory types: \- Buffer memory for storing all messages \- Window buffer memory for keeping a fixed number of recent interactions \- Summary memory for condensing conversations using LLMs \- Summary buffer memory combining buffer and summarization \- Vector store memory for semantic retrieval

Package memory provides observability and monitoring for memory implementations. It integrates OpenTelemetry for metrics and tracing as the default observability solution.

Package memory provides a standardized registry pattern for memory creation. This follows the Beluga AI Framework design patterns with consistent factory interfaces.

Package memory provides advanced test utilities and comprehensive mocks for testing memory implementations. This file contains utilities designed to support both unit tests and integration tests.

## Index

- [Constants](#constants>)
- [Variables](#variables>)
- [func AssertErrorType\(t \*testing.T, err error, expectedCode string\)](#AssertErrorType>)
- [func AssertHealthCheck\(t \*testing.T, health map\[string\]any, expectedStatus string\)](#AssertHealthCheck>)
- [func AssertMemoryContent\(t \*testing.T, content map\[string\]any, expectedKeys \[\]string\)](#AssertMemoryContent>)
- [func AssertMemoryVariables\(t \*testing.T, memory iface.Memory, expectedVars \[\]string\)](#AssertMemoryVariables>)
- [func AssertMessageHistory\(t \*testing.T, messages \[\]schema.Message, expectedCount int\)](#AssertMessageHistory>)
- [func CreateMemory\(ctx context.Context, memoryType string, config Config\) \(iface.Memory, error\)](#CreateMemory>)
- [func CreateTestInputOutput\(input, output string\) \(map\[string\]any, map\[string\]any\)](#CreateTestInputOutput>)
- [func CreateTestMessages\(count int\) \[\]schema.Message](#CreateTestMessages>)
- [func GetBufferString\(messages \[\]schema.Message, humanPrefix, aiPrefix string\) string](#GetBufferString>)
- [func GetInputOutputKeys\(inputs, outputs map\[string\]any\) \(string, string, error\)](#GetInputOutputKeys>)
- [func IsMemoryError\(err error, code string\) bool](#IsMemoryError>)
- [func ListAvailableMemoryTypes\(\) \[\]string](#ListAvailableMemoryTypes>)
- [func NewBaseChatMessageHistory\(options ...providers.BaseHistoryOption\) iface.ChatMessageHistory](#NewBaseChatMessageHistory>)
- [func NewChatMessageBufferMemory\(history iface.ChatMessageHistory\) iface.Memory](#NewChatMessageBufferMemory>)
- [func NewCompositeChatMessageHistory\(primary iface.ChatMessageHistory, options ...providers.CompositeHistoryOption\) iface.ChatMessageHistory](#NewCompositeChatMessageHistory>)
- [func NewConversationBufferWindowMemory\(history iface.ChatMessageHistory, k int, memoryKey string, returnMessages bool\) iface.Memory](#NewConversationBufferWindowMemory>)
- [func NewConversationSummaryBufferMemory\(history iface.ChatMessageHistory, llm core.Runnable, memoryKey string, maxTokenLimit int\) iface.Memory](#NewConversationSummaryBufferMemory>)
- [func NewConversationSummaryMemory\(history iface.ChatMessageHistory, llm core.Runnable, memoryKey string\) iface.Memory](#NewConversationSummaryMemory>)
- [func NewVectorStoreMemory\(retriever core.Retriever, memoryKey string, returnDocs bool, k int\) iface.Memory](#NewVectorStoreMemory>)
- [func NewVectorStoreRetrieverMemory\(embedder embeddingsiface.Embedder, vectorStore vectorstores.VectorStore, options ...vectorstore.VectorStoreMemoryOption\) iface.Memory](#NewVectorStoreRetrieverMemory>)
- [func RegisterMemoryType\(memoryType string, creator func\(ctx context.Context, config Config\) \(iface.Memory, error\)\)](#RegisterMemoryType>)
- [func RunLoadTest\(t \*testing.T, memory \*AdvancedMockMemory, numOperations, concurrency int\)](#RunLoadTest>)
- [func SetGlobalLogger\(logger \*Logger\)](#SetGlobalLogger>)
- [func SetGlobalMetrics\(meter metric.Meter\)](#SetGlobalMetrics>)
- [func SetGlobalTracer\(\)](#SetGlobalTracer>)
- [func WithMaxHistorySize\(maxSize int\) providers.BaseHistoryOption](#WithMaxHistorySize>)
- [func WithMaxSize\(maxSize int\) providers.CompositeHistoryOption](#WithMaxSize>)
- [func WithOnAddHook\(hook func\(context.Context, schema.Message\) error\) providers.CompositeHistoryOption](#WithOnAddHook>)
- [func WithOnGetHook\(hook func\(context.Context, \[\]schema.Message\) \(\[\]schema.Message, error\)\) providers.CompositeHistoryOption](#WithOnGetHook>)
- [func WithSecondaryHistory\(secondary iface.ChatMessageHistory\) providers.CompositeHistoryOption](#WithSecondaryHistory>)
- [type AdvancedMockChatMessageHistory](#AdvancedMockChatMessageHistory>)
  - [func NewAdvancedMockChatMessageHistory\(options ...MockHistoryOption\) \*AdvancedMockChatMessageHistory](#NewAdvancedMockChatMessageHistory>)
  - [func \(h \*AdvancedMockChatMessageHistory\) AddAIMessage\(ctx context.Context, content string\) error](#AdvancedMockChatMessageHistory.AddAIMessage>)
  - [func \(h \*AdvancedMockChatMessageHistory\) AddMessage\(ctx context.Context, message schema.Message\) error](#AdvancedMockChatMessageHistory.AddMessage>)
  - [func \(h \*AdvancedMockChatMessageHistory\) AddUserMessage\(ctx context.Context, content string\) error](#AdvancedMockChatMessageHistory.AddUserMessage>)
  - [func \(h \*AdvancedMockChatMessageHistory\) Clear\(ctx context.Context\) error](#AdvancedMockChatMessageHistory.Clear>)
  - [func \(h \*AdvancedMockChatMessageHistory\) GetCallCount\(\) int](#AdvancedMockChatMessageHistory.GetCallCount>)
  - [func \(h \*AdvancedMockChatMessageHistory\) GetMessages\(ctx context.Context\) \(\[\]schema.Message, error\)](#AdvancedMockChatMessageHistory.GetMessages>)
- [type AdvancedMockMemory](#AdvancedMockMemory>)
  - [func NewAdvancedMockMemory\(memoryKey string, memoryType MemoryType, options ...MockMemoryOption\) \*AdvancedMockMemory](#NewAdvancedMockMemory>)
  - [func \(m \*AdvancedMockMemory\) CheckHealth\(\) map\[string\]any](#AdvancedMockMemory.CheckHealth>)
  - [func \(m \*AdvancedMockMemory\) Clear\(ctx context.Context\) error](#AdvancedMockMemory.Clear>)
  - [func \(m \*AdvancedMockMemory\) GetCallCount\(\) int](#AdvancedMockMemory.GetCallCount>)
  - [func \(m \*AdvancedMockMemory\) GetContextHistory\(\) \[\]map\[string\]any](#AdvancedMockMemory.GetContextHistory>)
  - [func \(m \*AdvancedMockMemory\) GetMessages\(\) \[\]schema.Message](#AdvancedMockMemory.GetMessages>)
  - [func \(m \*AdvancedMockMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](#AdvancedMockMemory.LoadMemoryVariables>)
  - [func \(m \*AdvancedMockMemory\) MemoryVariables\(\) \[\]string](#AdvancedMockMemory.MemoryVariables>)
  - [func \(m \*AdvancedMockMemory\) SaveContext\(ctx context.Context, inputs, outputs map\[string\]any\) error](#AdvancedMockMemory.SaveContext>)
- [type AdvancedMockcomponent](#AdvancedMockcomponent>)
  - [func NewAdvancedMockcomponent\(\) \*AdvancedMockcomponent](#NewAdvancedMockcomponent>)
- [type BufferConfig](#BufferConfig>)
- [type ChatMessageHistory](#ChatMessageHistory>)
- [type ConcurrentTestRunner](#ConcurrentTestRunner>)
  - [func NewConcurrentTestRunner\(numGoroutines int, duration time.Duration, testFunc func\(\) error\) \*ConcurrentTestRunner](#NewConcurrentTestRunner>)
  - [func \(r \*ConcurrentTestRunner\) Run\(\) error](#ConcurrentTestRunner.Run>)
- [type Config](#Config>)
  - [func CreateTestMemoryConfig\(memoryType MemoryType\) Config](#CreateTestMemoryConfig>)
- [type DefaultFactory](#DefaultFactory>)
  - [func \(f \*DefaultFactory\) CreateMemory\(ctx context.Context, config Config\) \(Memory, error\)](#DefaultFactory.CreateMemory>)
- [type Factory](#Factory>)
  - [func NewFactory\(\) Factory](#NewFactory>)
- [type IntegrationTestHelper](#IntegrationTestHelper>)
  - [func NewIntegrationTestHelper\(\) \*IntegrationTestHelper](#NewIntegrationTestHelper>)
  - [func \(h \*IntegrationTestHelper\) AddHistory\(name string, history \*AdvancedMockChatMessageHistory\)](#IntegrationTestHelper.AddHistory>)
  - [func \(h \*IntegrationTestHelper\) AddMemory\(name string, memory \*AdvancedMockMemory\)](#IntegrationTestHelper.AddMemory>)
  - [func \(h \*IntegrationTestHelper\) GetHistory\(name string\) \*AdvancedMockChatMessageHistory](#IntegrationTestHelper.GetHistory>)
  - [func \(h \*IntegrationTestHelper\) GetMemory\(name string\) \*AdvancedMockMemory](#IntegrationTestHelper.GetMemory>)
  - [func \(h \*IntegrationTestHelper\) Reset\(\)](#IntegrationTestHelper.Reset>)
- [type Logger](#Logger>)
  - [func GetGlobalLogger\(\) \*Logger](#GetGlobalLogger>)
  - [func NewLogger\(logger \*slog.Logger\) \*Logger](#NewLogger>)
  - [func \(l \*Logger\) LogError\(ctx context.Context, err error, operation string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr\)](#Logger.LogError>)
  - [func \(l \*Logger\) LogMemoryLifecycle\(ctx context.Context, event string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr\)](#Logger.LogMemoryLifecycle>)
  - [func \(l \*Logger\) LogMemoryOperation\(ctx context.Context, level slog.Level, operation string, memoryType MemoryType, memoryKey string, messageCount int, duration time.Duration, err error\)](#Logger.LogMemoryOperation>)
- [type Memory](#Memory>)
  - [func NewMemory\(memoryType MemoryType, options ...Option\) \(Memory, error\)](#NewMemory>)
- [type MemoryError](#MemoryError>)
  - [func ErrContextCanceled\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrContextCanceled>)
  - [func ErrDeserialization\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrDeserialization>)
  - [func ErrInvalidConfig\(memoryType MemoryType, err error\) \*MemoryError](#ErrInvalidConfig>)
  - [func ErrInvalidInput\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrInvalidInput>)
  - [func ErrMemoryOverflow\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrMemoryOverflow>)
  - [func ErrNotFound\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrNotFound>)
  - [func ErrRetrievalError\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrRetrievalError>)
  - [func ErrSerialization\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrSerialization>)
  - [func ErrStorageError\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrStorageError>)
  - [func ErrTimeout\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrTimeout>)
  - [func ErrTypeMismatch\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrTypeMismatch>)
  - [func ErrValidation\(op string, memoryType MemoryType, err error\) \*MemoryError](#ErrValidation>)
  - [func NewMemoryError\(op string, memoryType MemoryType, code string, err error\) \*MemoryError](#NewMemoryError>)
  - [func WrapError\(err error, op string, memoryType MemoryType, code string\) \*MemoryError](#WrapError>)
  - [func \(e \*MemoryError\) Error\(\) string](#MemoryError.Error>)
  - [func \(e \*MemoryError\) Is\(target error\) bool](#MemoryError.Is>)
  - [func \(e \*MemoryError\) Unwrap\(\) error](#MemoryError.Unwrap>)
  - [func \(e \*MemoryError\) WithContext\(key string, value any\) \*MemoryError](#MemoryError.WithContext>)
- [type MemoryFactory](#MemoryFactory>)
- [type MemoryMockcomponent](#MemoryMockcomponent>)
  - [func NewMemoryMockcomponent\(\) \*MemoryMockcomponent](#NewMemoryMockcomponent>)
- [type MemoryRegistry](#MemoryRegistry>)
  - [func GetGlobalMemoryRegistry\(\) \*MemoryRegistry](#GetGlobalMemoryRegistry>)
  - [func NewMemoryRegistry\(\) \*MemoryRegistry](#NewMemoryRegistry>)
  - [func \(r \*MemoryRegistry\) Create\(ctx context.Context, memoryType string, config Config\) \(iface.Memory, error\)](#MemoryRegistry.Create>)
  - [func \(r \*MemoryRegistry\) ListMemoryTypes\(\) \[\]string](#MemoryRegistry.ListMemoryTypes>)
  - [func \(r \*MemoryRegistry\) Register\(memoryType string, creator func\(ctx context.Context, config Config\) \(iface.Memory, error\)\)](#MemoryRegistry.Register>)
- [type MemoryScenarioRunner](#MemoryScenarioRunner>)
  - [func NewMemoryScenarioRunner\(memory iface.Memory\) \*MemoryScenarioRunner](#NewMemoryScenarioRunner>)
  - [func \(r \*MemoryScenarioRunner\) RunConversationScenario\(ctx context.Context, exchanges int\) error](#MemoryScenarioRunner.RunConversationScenario>)
  - [func \(r \*MemoryScenarioRunner\) RunMemoryRetentionTest\(ctx context.Context, initialSize, targetSize int\) error](#MemoryScenarioRunner.RunMemoryRetentionTest>)
- [type MemoryType](#MemoryType>)
- [type Metrics](#Metrics>)
  - [func GetGlobalMetrics\(\) \*Metrics](#GetGlobalMetrics>)
  - [func NewMetrics\(meter metric.Meter\) \*Metrics](#NewMetrics>)
  - [func \(m \*Metrics\) RecordActiveMemory\(ctx context.Context, memoryType MemoryType, delta int64\)](#Metrics.RecordActiveMemory>)
  - [func \(m \*Metrics\) RecordError\(ctx context.Context, operation string, memoryType MemoryType, errorType string\)](#Metrics.RecordError>)
  - [func \(m \*Metrics\) RecordMemorySize\(ctx context.Context, memoryType MemoryType, size int\)](#Metrics.RecordMemorySize>)
  - [func \(m \*Metrics\) RecordOperation\(ctx context.Context, operation string, memoryType MemoryType, success bool\)](#Metrics.RecordOperation>)
  - [func \(m \*Metrics\) RecordOperationDuration\(ctx context.Context, operation string, memoryType MemoryType, duration time.Duration\)](#Metrics.RecordOperationDuration>)
- [type MetricsMockcomponent](#MetricsMockcomponent>)
  - [func NewMetricsMockcomponent\(\) \*MetricsMockcomponent](#NewMetricsMockcomponent>)
- [type MockHistoryOption](#MockHistoryOption>)
  - [func WithHistoryDelay\(delay time.Duration\) MockHistoryOption](#WithHistoryDelay>)
  - [func WithHistoryError\(shouldError bool, err error\) MockHistoryOption](#WithHistoryError>)
  - [func WithHistoryMaxSize\(size int\) MockHistoryOption](#WithHistoryMaxSize>)
  - [func WithPreloadedHistoryMessages\(messages \[\]schema.Message\) MockHistoryOption](#WithPreloadedHistoryMessages>)
- [type MockMemoryOption](#MockMemoryOption>)
  - [func WithMaxMemorySize\(size int\) MockMemoryOption](#WithMaxMemorySize>)
  - [func WithMemoryVariables\(variables \[\]string\) MockMemoryOption](#WithMemoryVariables>)
  - [func WithMockError\(shouldError bool, err error\) MockMemoryOption](#WithMockError>)
  - [func WithMockReturnMessages\(returnMessages bool\) MockMemoryOption](#WithMockReturnMessages>)
  - [func WithPreloadedMessages\(messages \[\]schema.Message\) MockMemoryOption](#WithPreloadedMessages>)
  - [func WithSimulateDelay\(delay time.Duration\) MockMemoryOption](#WithSimulateDelay>)
- [type NoOpMemory](#NoOpMemory>)
  - [func \(m \*NoOpMemory\) Clear\(ctx context.Context\) error](#NoOpMemory.Clear>)
  - [func \(m \*NoOpMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](#NoOpMemory.LoadMemoryVariables>)
  - [func \(m \*NoOpMemory\) MemoryVariables\(\) \[\]string](#NoOpMemory.MemoryVariables>)
  - [func \(m \*NoOpMemory\) SaveContext\(ctx context.Context, inputs, outputs map\[string\]any\) error](#NoOpMemory.SaveContext>)
- [type Option](#Option>)
  - [func WithAIPrefix\(prefix string\) Option](#WithAIPrefix>)
  - [func WithHumanPrefix\(prefix string\) Option](#WithHumanPrefix>)
  - [func WithInputKey\(key string\) Option](#WithInputKey>)
  - [func WithMaxTokenLimit\(limit int\) Option](#WithMaxTokenLimit>)
  - [func WithMemoryKey\(key string\) Option](#WithMemoryKey>)
  - [func WithOutputKey\(key string\) Option](#WithOutputKey>)
  - [func WithReturnMessages\(returnMessages bool\) Option](#WithReturnMessages>)
  - [func WithTimeout\(timeout time.Duration\) Option](#WithTimeout>)
  - [func WithTopK\(k int\) Option](#WithTopK>)
  - [func WithWindowSize\(size int\) Option](#WithWindowSize>)
- [type SummaryConfig](#SummaryConfig>)
- [type Tracer](#Tracer>)
  - [func GetGlobalTracer\(\) \*Tracer](#GetGlobalTracer>)
  - [func NewTracer\(\) \*Tracer](#NewTracer>)
  - [func \(t \*Tracer\) RecordSpanError\(span trace.Span, err error\)](#Tracer.RecordSpanError>)
  - [func \(t \*Tracer\) StartSpan\(ctx context.Context, operation string, memoryType MemoryType, memoryKey string\) \(context.Context, trace.Span\)](#Tracer.StartSpan>)
- [type VectorStoreConfig](#VectorStoreConfig>)

## Constants

Error codes for common memory operations.

```go
const (
    ErrCodeInvalidConfig   = "invalid_config"
    ErrCodeInvalidInput    = "invalid_input"
    ErrCodeStorageError    = "storage_error"
    ErrCodeRetrievalError  = "retrieval_error"
    ErrCodeTimeout         = "timeout"
    ErrCodeNotFound        = "not_found"
    ErrCodeTypeMismatch    = "type_mismatch"
    ErrCodeSerialization   = "serialization_error"
    ErrCodeDeserialization = "deserialization_error"
    ErrCodeValidation      = "validation_error"
    ErrCodeMemoryOverflow  = "memory_overflow"
    ErrCodeContextCanceled = "context_canceled"
)
```

## Variables

Default convenience functions that use the global logger.

```go
var (
    LogMemoryOperation = func(ctx context.Context, level slog.Level, operation string, memoryType MemoryType, memoryKey string, messageCount int, duration time.Duration, err error) {
        GetGlobalLogger().LogMemoryOperation(ctx, level, operation, memoryType, memoryKey, messageCount, duration, err)
    }

    LogMemoryLifecycle = func(ctx context.Context, event string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr) {
        GetGlobalLogger().LogMemoryLifecycle(ctx, event, memoryType, memoryKey, additionalAttrs...)
    }

    LogError = func(ctx context.Context, err error, operation string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr) {
        GetGlobalLogger().LogError(ctx, err, operation, memoryType, memoryKey, additionalAttrs...)
    }
)
```


## func [AssertErrorType](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L479)

```go
func AssertErrorType(t *testing.T, err error, expectedCode string)
```

AssertErrorType validates error types and codes.


## func [AssertHealthCheck](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L470)

```go
func AssertHealthCheck(t *testing.T, health map[string]any, expectedStatus string)
```

AssertHealthCheck validates health check results.


## func [AssertMemoryContent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L448)

```go
func AssertMemoryContent(t *testing.T, content map[string]any, expectedKeys []string)
```

AssertMemoryContent validates memory content.


## func [AssertMemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L441)

```go
func AssertMemoryVariables(t *testing.T, memory iface.Memory, expectedVars []string)
```

AssertMemoryVariables validates memory variables.


## func [AssertMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L457)

```go
func AssertMessageHistory(t *testing.T, messages []schema.Message, expectedCount int)
```

AssertMessageHistory validates message history.


## func [CreateMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L83)

```go
func CreateMemory(ctx context.Context, memoryType string, config Config) (iface.Memory, error)
```

CreateMemory creates a memory using the global registry.


## func [CreateTestInputOutput](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L428)

```go
func CreateTestInputOutput(input, output string) (map[string]any, map[string]any)
```

CreateTestInputOutput creates test input/output maps.


## func [CreateTestMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L396)

```go
func CreateTestMessages(count int) []schema.Message
```

CreateTestMessages creates a set of test messages.


## func [GetBufferString](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L303)

```go
func GetBufferString(messages []schema.Message, humanPrefix, aiPrefix string) string
```

GetBufferString formats messages into a text buffer with human/AI prefixes. This utility function is exposed for use by memory implementations.


## func [GetInputOutputKeys](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L252)

```go
func GetInputOutputKeys(inputs, outputs map[string]any) (string, string, error)
```

GetInputOutputKeys determines the input and output keys from the given maps. This utility function is exposed for use by memory implementations.


## func [IsMemoryError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L87)

```go
func IsMemoryError(err error, code string) bool
```

IsMemoryError checks if an error is a MemoryError with the given code.


## func [ListAvailableMemoryTypes](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L88)

```go
func ListAvailableMemoryTypes() []string
```

ListAvailableMemoryTypes returns all available memory types from the global registry.


## func [NewBaseChatMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L332)

```go
func NewBaseChatMessageHistory(options ...providers.BaseHistoryOption) iface.ChatMessageHistory
```

NewBaseChatMessageHistory creates a new base chat message history with functional options.


## func [NewChatMessageBufferMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L367)

```go
func NewChatMessageBufferMemory(history iface.ChatMessageHistory) iface.Memory
```

NewChatMessageBufferMemory creates a new chat message buffer memory.


## func [NewCompositeChatMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L342)

```go
func NewCompositeChatMessageHistory(primary iface.ChatMessageHistory, options ...providers.CompositeHistoryOption) iface.ChatMessageHistory
```

NewCompositeChatMessageHistory creates a new composite chat message history with functional options.


## func [NewConversationBufferWindowMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L372)

```go
func NewConversationBufferWindowMemory(history iface.ChatMessageHistory, k int, memoryKey string, returnMessages bool) iface.Memory
```

NewConversationBufferWindowMemory creates a new conversation buffer window memory.


## func [NewConversationSummaryBufferMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L382)

```go
func NewConversationSummaryBufferMemory(history iface.ChatMessageHistory, llm core.Runnable, memoryKey string, maxTokenLimit int) iface.Memory
```

NewConversationSummaryBufferMemory creates a new conversation summary buffer memory.


## func [NewConversationSummaryMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L377)

```go
func NewConversationSummaryMemory(history iface.ChatMessageHistory, llm core.Runnable, memoryKey string) iface.Memory
```

NewConversationSummaryMemory creates a new conversation summary memory.


## func [NewVectorStoreMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L387)

```go
func NewVectorStoreMemory(retriever core.Retriever, memoryKey string, returnDocs bool, k int) iface.Memory
```

NewVectorStoreMemory creates a new vector store memory.


## func [NewVectorStoreRetrieverMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L392)

```go
func NewVectorStoreRetrieverMemory(embedder embeddingsiface.Embedder, vectorStore vectorstores.VectorStore, options ...vectorstore.VectorStoreMemoryOption) iface.Memory
```

NewVectorStoreRetrieverMemory creates a new vector store retriever memory.


## func [RegisterMemoryType](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L78)

```go
func RegisterMemoryType(memoryType string, creator func(ctx context.Context, config Config) (iface.Memory, error))
```

RegisterMemoryType registers a memory type with the global registry.


## func [RunLoadTest](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L550)

```go
func RunLoadTest(t *testing.T, memory *AdvancedMockMemory, numOperations, concurrency int)
```

RunLoadTest executes a load test scenario on memory.


## func [SetGlobalLogger](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L305)

```go
func SetGlobalLogger(logger *Logger)
```

SetGlobalLogger sets the global logger instance.


## func [SetGlobalMetrics](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L189)

```go
func SetGlobalMetrics(meter metric.Meter)
```

SetGlobalMetrics sets the global metrics instance with proper OTEL meter.


## func [SetGlobalTracer](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L199)

```go
func SetGlobalTracer()
```

SetGlobalTracer sets the global tracer instance.


## func [WithMaxHistorySize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L337)

```go
func WithMaxHistorySize(maxSize int) providers.BaseHistoryOption
```

WithMaxHistorySize sets the maximum number of messages for the base history.


## func [WithMaxSize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L352)

```go
func WithMaxSize(maxSize int) providers.CompositeHistoryOption
```

WithMaxSize sets the maximum number of messages for the composite history.


## func [WithOnAddHook](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L357)

```go
func WithOnAddHook(hook func(context.Context, schema.Message) error) providers.CompositeHistoryOption
```

WithOnAddHook sets an add hook for the composite history.


## func [WithOnGetHook](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L362)

```go
func WithOnGetHook(hook func(context.Context, []schema.Message) ([]schema.Message, error)) providers.CompositeHistoryOption
```

WithOnGetHook sets a get hook for the composite history.


## func [WithSecondaryHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L347)

```go
func WithSecondaryHistory(secondary iface.ChatMessageHistory) providers.CompositeHistoryOption
```

WithSecondaryHistory sets a secondary history for the composite history.


## type [AdvancedMockChatMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L258-L267)

AdvancedMockChatMessageHistory provides a comprehensive mock for chat message history.

```go
type AdvancedMockChatMessageHistory struct {
    mock.Mock
    // contains filtered or unexported fields
}
```


### func [NewAdvancedMockChatMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L270)

```go
func NewAdvancedMockChatMessageHistory(options ...MockHistoryOption) *AdvancedMockChatMessageHistory
```

NewAdvancedMockChatMessageHistory creates a new advanced mock chat message history.


### func \(\*AdvancedMockChatMessageHistory\) [AddAIMessage](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L346)

```go
func (h *AdvancedMockChatMessageHistory) AddAIMessage(ctx context.Context, content string) error
```


### func \(\*AdvancedMockChatMessageHistory\) [AddMessage](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L318)

```go
func (h *AdvancedMockChatMessageHistory) AddMessage(ctx context.Context, message schema.Message) error
```

Mock implementation methods for ChatMessageHistory.


### func \(\*AdvancedMockChatMessageHistory\) [AddUserMessage](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L342)

```go
func (h *AdvancedMockChatMessageHistory) AddUserMessage(ctx context.Context, content string) error
```


### func \(\*AdvancedMockChatMessageHistory\) [Clear](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L369)

```go
func (h *AdvancedMockChatMessageHistory) Clear(ctx context.Context) error
```


### func \(\*AdvancedMockChatMessageHistory\) [GetCallCount](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L387)

```go
func (h *AdvancedMockChatMessageHistory) GetCallCount() int
```


### func \(\*AdvancedMockChatMessageHistory\) [GetMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L350)

```go
func (h *AdvancedMockChatMessageHistory) GetMessages(ctx context.Context) ([]schema.Message, error)
```


## type [AdvancedMockMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L21-L38)

AdvancedMockMemory provides a comprehensive mock implementation for testing.

```go
type AdvancedMockMemory struct {
    mock.Mock
    // contains filtered or unexported fields
}
```


### func [NewAdvancedMockMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L41)

```go
func NewAdvancedMockMemory(memoryKey string, memoryType MemoryType, options ...MockMemoryOption) *AdvancedMockMemory
```

NewAdvancedMockMemory creates a new advanced mock with configurable behavior.


### func \(\*AdvancedMockMemory\) [CheckHealth](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L244)

```go
func (m *AdvancedMockMemory) CheckHealth() map[string]any
```


### func \(\*AdvancedMockMemory\) [Clear](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L201)

```go
func (m *AdvancedMockMemory) Clear(ctx context.Context) error
```


### func \(\*AdvancedMockMemory\) [GetCallCount](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L222)

```go
func (m *AdvancedMockMemory) GetCallCount() int
```


### func \(\*AdvancedMockMemory\) [GetContextHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L236)

```go
func (m *AdvancedMockMemory) GetContextHistory() []map[string]any
```


### func \(\*AdvancedMockMemory\) [GetMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L228)

```go
func (m *AdvancedMockMemory) GetMessages() []schema.Message
```


### func \(\*AdvancedMockMemory\) [LoadMemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L115)

```go
func (m *AdvancedMockMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```


### func \(\*AdvancedMockMemory\) [MemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L109)

```go
func (m *AdvancedMockMemory) MemoryVariables() []string
```

Mock implementation methods.


### func \(\*AdvancedMockMemory\) [SaveContext](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L153)

```go
func (m *AdvancedMockMemory) SaveContext(ctx context.Context, inputs, outputs map[string]any) error
```


## type [AdvancedMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/advanced_mock.go#L8-L10)

AdvancedMockcomponent is a mock implementation of Interface.

```go
type AdvancedMockcomponent struct {
    mock.Mock
}
```


### func [NewAdvancedMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/advanced_mock.go#L13)

```go
func NewAdvancedMockcomponent() *AdvancedMockcomponent
```

NewAdvancedMockcomponent creates a new AdvancedMockcomponent.


## type [BufferConfig](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L53-L56)

BufferConfig holds configuration specific to buffer memory implementations.

```go
type BufferConfig struct {
    ChatHistory ChatMessageHistory
    Config      `mapstructure:",squash"`
}
```


## type [ChatMessageHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L42)

Ensure the main interfaces are imported for external use.

```go
type ChatMessageHistory = iface.ChatMessageHistory
```


## type [ConcurrentTestRunner](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L491-L495)

ConcurrentTestRunner runs memory tests concurrently for performance testing.

```go
type ConcurrentTestRunner struct {
    NumGoroutines int
    TestDuration  time.Duration
    // contains filtered or unexported fields
}
```


### func [NewConcurrentTestRunner](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L497)

```go
func NewConcurrentTestRunner(numGoroutines int, duration time.Duration, testFunc func() error) *ConcurrentTestRunner
```


### func \(\*ConcurrentTestRunner\) [Run](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L505)

```go
func (r *ConcurrentTestRunner) Run() error
```


## type [Config](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L37-L50)

Config holds the configuration for memory implementations. It uses struct tags for validation and mapping to configuration sources.

```go
type Config struct {
    Type           MemoryType    `mapstructure:"type" yaml:"type" env:"MEMORY_TYPE" validate:"required,oneof=buffer buffer_window summary summary_buffer vector_store vector_store_retriever"`
    MemoryKey      string        `mapstructure:"memory_key" yaml:"memory_key" env:"MEMORY_KEY" default:"history"`
    InputKey       string        `mapstructure:"input_key" yaml:"input_key" env:"INPUT_KEY" default:"input"`
    OutputKey      string        `mapstructure:"output_key" yaml:"output_key" env:"OUTPUT_KEY" default:"output"`
    HumanPrefix    string        `mapstructure:"human_prefix" yaml:"human_prefix" env:"HUMAN_PREFIX" default:"Human"`
    AIPrefix       string        `mapstructure:"ai_prefix" yaml:"ai_prefix" env:"AI_PREFIX" default:"AI"`
    WindowSize     int           `mapstructure:"window_size" yaml:"window_size" env:"WINDOW_SIZE" default:"5"`
    MaxTokenLimit  int           `mapstructure:"max_token_limit" yaml:"max_token_limit" env:"MAX_TOKEN_LIMIT" default:"2000"`
    TopK           int           `mapstructure:"top_k" yaml:"top_k" env:"TOP_K" default:"4"`
    Timeout        time.Duration `mapstructure:"timeout" yaml:"timeout" env:"MEMORY_TIMEOUT" default:"30s"`
    ReturnMessages bool          `mapstructure:"return_messages" yaml:"return_messages" env:"RETURN_MESSAGES" default:"false"`
    Enabled        bool          `mapstructure:"enabled" yaml:"enabled" env:"MEMORY_ENABLED" default:"true"`
}
```


### func [CreateTestMemoryConfig](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L410)

```go
func CreateTestMemoryConfig(memoryType MemoryType) Config
```

CreateTestMemoryConfig creates a test memory configuration.


## type [DefaultFactory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L51)

DefaultFactory is the default implementation of the Factory interface.

```go
type DefaultFactory struct{}
```


### func \(\*DefaultFactory\) [CreateMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L60)

```go
func (f *DefaultFactory) CreateMemory(ctx context.Context, config Config) (Memory, error)
```

CreateMemory creates a memory instance based on the provided configuration. It validates the configuration and instantiates the appropriate memory implementation.


## type [Factory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L46-L48)

Factory defines the interface for creating Memory instances.

```go
type Factory interface {
    CreateMemory(ctx context.Context, config Config) (Memory, error)
}
```


### func [NewFactory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L54)

```go
func NewFactory() Factory
```

NewFactory creates a new memory factory.


## type [IntegrationTestHelper](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L602-L605)

IntegrationTestHelper provides utilities for integration testing.

```go
type IntegrationTestHelper struct {
    // contains filtered or unexported fields
}
```


### func [NewIntegrationTestHelper](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L607)

```go
func NewIntegrationTestHelper() *IntegrationTestHelper
```


### func \(\*IntegrationTestHelper\) [AddHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L618)

```go
func (h *IntegrationTestHelper) AddHistory(name string, history *AdvancedMockChatMessageHistory)
```


### func \(\*IntegrationTestHelper\) [AddMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L614)

```go
func (h *IntegrationTestHelper) AddMemory(name string, memory *AdvancedMockMemory)
```


### func \(\*IntegrationTestHelper\) [GetHistory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L626)

```go
func (h *IntegrationTestHelper) GetHistory(name string) *AdvancedMockChatMessageHistory
```


### func \(\*IntegrationTestHelper\) [GetMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L622)

```go
func (h *IntegrationTestHelper) GetMemory(name string) *AdvancedMockMemory
```


### func \(\*IntegrationTestHelper\) [Reset](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L630)

```go
func (h *IntegrationTestHelper) Reset()
```


## type [Logger](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L210-L212)

Logger provides structured logging for memory operations. It integrates with OpenTelemetry tracing for consistent log correlation.

```go
type Logger struct {
    // contains filtered or unexported fields
}
```


### func [GetGlobalLogger](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L310)

```go
func GetGlobalLogger() *Logger
```

GetGlobalLogger returns the global logger instance.


### func [NewLogger](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L215)

```go
func NewLogger(logger *slog.Logger) *Logger
```

NewLogger creates a new structured logger for memory operations.


### func \(\*Logger\) [LogError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L277)

```go
func (l *Logger) LogError(ctx context.Context, err error, operation string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr)
```

LogError logs errors with context.


### func \(\*Logger\) [LogMemoryLifecycle](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L253)

```go
func (l *Logger) LogMemoryLifecycle(ctx context.Context, event string, memoryType MemoryType, memoryKey string, additionalAttrs ...slog.Attr)
```

LogMemoryLifecycle logs memory lifecycle events.


### func \(\*Logger\) [LogMemoryOperation](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L225)

```go
func (l *Logger) LogMemoryOperation(ctx context.Context, level slog.Level, operation string, memoryType MemoryType, memoryKey string, messageCount int, duration time.Duration, err error)
```

LogMemoryOperation logs memory operations with context.


## type [Memory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L41)

Ensure the main interfaces are imported for external use.

```go
type Memory = iface.Memory
```


### func [NewMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L200)

```go
func NewMemory(memoryType MemoryType, options ...Option) (Memory, error)
```

NewMemory is a convenience function for creating memory instances with functional options.


## type [MemoryError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L12-L18)

MemoryError represents a memory\-specific error with additional context.

```go
type MemoryError struct {
    Err        error
    Context    map[string]any
    Op         string
    Code       string
    MemoryType MemoryType
}
```


### func [ErrContextCanceled](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L153)

```go
func ErrContextCanceled(op string, memoryType MemoryType, err error) *MemoryError
```

ErrContextCanceled returns an error for context cancellation.


### func [ErrDeserialization](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L138)

```go
func ErrDeserialization(op string, memoryType MemoryType, err error) *MemoryError
```

ErrDeserialization returns an error for deserialization failures.


### func [ErrInvalidConfig](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L98)

```go
func ErrInvalidConfig(memoryType MemoryType, err error) *MemoryError
```

ErrInvalidConfig returns an error for invalid configuration.


### func [ErrInvalidInput](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L103)

```go
func ErrInvalidInput(op string, memoryType MemoryType, err error) *MemoryError
```

ErrInvalidInput returns an error for invalid input parameters.


### func [ErrMemoryOverflow](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L148)

```go
func ErrMemoryOverflow(op string, memoryType MemoryType, err error) *MemoryError
```

ErrMemoryOverflow returns an error for memory overflow conditions.


### func [ErrNotFound](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L123)

```go
func ErrNotFound(op string, memoryType MemoryType, err error) *MemoryError
```

ErrNotFound returns an error for not found conditions.


### func [ErrRetrievalError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L113)

```go
func ErrRetrievalError(op string, memoryType MemoryType, err error) *MemoryError
```

ErrRetrievalError returns an error for retrieval operation failures.


### func [ErrSerialization](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L133)

```go
func ErrSerialization(op string, memoryType MemoryType, err error) *MemoryError
```

ErrSerialization returns an error for serialization failures.


### func [ErrStorageError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L108)

```go
func ErrStorageError(op string, memoryType MemoryType, err error) *MemoryError
```

ErrStorageError returns an error for storage operation failures.


### func [ErrTimeout](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L118)

```go
func ErrTimeout(op string, memoryType MemoryType, err error) *MemoryError
```

ErrTimeout returns an error for timeout conditions.


### func [ErrTypeMismatch](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L128)

```go
func ErrTypeMismatch(op string, memoryType MemoryType, err error) *MemoryError
```

ErrTypeMismatch returns an error for type mismatch conditions.


### func [ErrValidation](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L143)

```go
func ErrValidation(op string, memoryType MemoryType, err error) *MemoryError
```

ErrValidation returns an error for validation failures.


### func [NewMemoryError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L59)

```go
func NewMemoryError(op string, memoryType MemoryType, code string, err error) *MemoryError
```

NewMemoryError creates a new MemoryError with the given parameters.


### func [WrapError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L79)

```go
func WrapError(err error, op string, memoryType MemoryType, code string) *MemoryError
```

WrapError wraps an existing error with memory\-specific context.


### func \(\*MemoryError\) [Error](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L21)

```go
func (e *MemoryError) Error() string
```

Error implements the error interface.


### func \(\*MemoryError\) [Is](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L34)

```go
func (e *MemoryError) Is(target error) bool
```

Is implements error comparison for specific error codes.


### func \(\*MemoryError\) [Unwrap](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L29)

```go
func (e *MemoryError) Unwrap() error
```

Unwrap returns the underlying error.


### func \(\*MemoryError\) [WithContext](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/errors.go#L70)

```go
func (e *MemoryError) WithContext(key string, value any) *MemoryError
```

WithContext adds context information to the error.


## type [MemoryFactory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L18-L22)

MemoryFactory defines the interface for creating Memory instances. This enables dependency injection and makes testing easier.

```go
type MemoryFactory interface {
    // CreateMemory creates a new Memory instance with the given configuration.
    // The config parameter contains memory-type-specific settings.
    CreateMemory(ctx context.Context, config Config) (iface.Memory, error)
}
```


## type [MemoryMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory_mock.go#L8-L10)

MemoryMockcomponent is a mock implementation of Interface.

```go
type MemoryMockcomponent struct {
    mock.Mock
}
```


### func [NewMemoryMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory_mock.go#L13)

```go
func NewMemoryMockcomponent() *MemoryMockcomponent
```

NewMemoryMockcomponent creates a new MemoryMockcomponent.


## type [MemoryRegistry](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L26-L29)

MemoryRegistry is the global registry for creating memory instances. It maintains a registry of available memory types and their creation functions.

```go
type MemoryRegistry struct {
    // contains filtered or unexported fields
}
```


### func [GetGlobalMemoryRegistry](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L93)

```go
func GetGlobalMemoryRegistry() *MemoryRegistry
```

GetGlobalMemoryRegistry returns the global registry instance for advanced usage.


### func [NewMemoryRegistry](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L32)

```go
func NewMemoryRegistry() *MemoryRegistry
```

NewMemoryRegistry creates a new MemoryRegistry instance.


### func \(\*MemoryRegistry\) [Create](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L46)

```go
func (r *MemoryRegistry) Create(ctx context.Context, memoryType string, config Config) (iface.Memory, error)
```

Create creates a new memory instance using the registered memory type.


### func \(\*MemoryRegistry\) [ListMemoryTypes](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L63)

```go
func (r *MemoryRegistry) ListMemoryTypes() []string
```

ListMemoryTypes returns a list of all registered memory type names.


### func \(\*MemoryRegistry\) [Register](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/registry.go#L39)

```go
func (r *MemoryRegistry) Register(memoryType string, creator func(ctx context.Context, config Config) (iface.Memory, error))
```

Register registers a new memory type with the registry.


## type [MemoryScenarioRunner](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L642-L644)

MemoryScenarioRunner runs common memory scenarios.

```go
type MemoryScenarioRunner struct {
    // contains filtered or unexported fields
}
```


### func [NewMemoryScenarioRunner](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L646)

```go
func NewMemoryScenarioRunner(memory iface.Memory) *MemoryScenarioRunner
```


### func \(\*MemoryScenarioRunner\) [RunConversationScenario](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L650)

```go
func (r *MemoryScenarioRunner) RunConversationScenario(ctx context.Context, exchanges int) error
```


### func \(\*MemoryScenarioRunner\) [RunMemoryRetentionTest](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L673)

```go
func (r *MemoryScenarioRunner) RunMemoryRetentionTest(ctx context.Context, initialSize, targetSize int) error
```


## type [MemoryType](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L13)

MemoryType represents the type of memory implementation to use.

```go
type MemoryType string
```



```go
const (
    // MemoryTypeBuffer represents buffer memory that stores all messages.
    MemoryTypeBuffer MemoryType = "buffer"

    // MemoryTypeBufferWindow represents window buffer memory with a fixed size.
    MemoryTypeBufferWindow MemoryType = "buffer_window"

    // MemoryTypeSummary represents summary memory that condenses conversations.
    MemoryTypeSummary MemoryType = "summary"

    // MemoryTypeSummaryBuffer represents summary buffer memory combining both approaches.
    MemoryTypeSummaryBuffer MemoryType = "summary_buffer"

    // MemoryTypeVectorStore represents vector store memory for semantic retrieval.
    MemoryTypeVectorStore MemoryType = "vector_store"

    // MemoryTypeVectorStoreRetriever represents vector store retriever memory.
    MemoryTypeVectorStoreRetriever MemoryType = "vector_store_retriever"
)
```


## type [Metrics](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L17-L26)

Metrics holds the metric instruments for memory operations.

```go
type Metrics struct {
    // contains filtered or unexported fields
}
```


### func [GetGlobalMetrics](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L194)

```go
func GetGlobalMetrics() *Metrics
```

GetGlobalMetrics returns the global metrics instance.


### func [NewMetrics](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L29)

```go
func NewMetrics(meter metric.Meter) *Metrics
```

NewMetrics creates a new Metrics instance with proper OTEL integration.


### func \(\*Metrics\) [RecordActiveMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L139)

```go
func (m *Metrics) RecordActiveMemory(ctx context.Context, memoryType MemoryType, delta int64)
```

RecordActiveMemory records the creation or deletion of a memory instance.


### func \(\*Metrics\) [RecordError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L115)

```go
func (m *Metrics) RecordError(ctx context.Context, operation string, memoryType MemoryType, errorType string)
```

RecordError records a memory error.


### func \(\*Metrics\) [RecordMemorySize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L128)

```go
func (m *Metrics) RecordMemorySize(ctx context.Context, memoryType MemoryType, size int)
```

RecordMemorySize records the size/length of memory content.


### func \(\*Metrics\) [RecordOperation](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L75)

```go
func (m *Metrics) RecordOperation(ctx context.Context, operation string, memoryType MemoryType, success bool)
```

RecordOperation records a memory operation with its attributes.


### func \(\*Metrics\) [RecordOperationDuration](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L88)

```go
func (m *Metrics) RecordOperationDuration(ctx context.Context, operation string, memoryType MemoryType, duration time.Duration)
```

RecordOperationDuration records the duration of a memory operation.


## type [MetricsMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics_mock.go#L8-L10)

MetricsMockcomponent is a mock implementation of Interface.

```go
type MetricsMockcomponent struct {
    mock.Mock
}
```


### func [NewMetricsMockcomponent](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics_mock.go#L13)

```go
func NewMetricsMockcomponent() *MetricsMockcomponent
```

NewMetricsMockcomponent creates a new MetricsMockcomponent.


## type [MockHistoryOption](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L285)

MockHistoryOption defines functional options for mock history configuration.

```go
type MockHistoryOption func(*AdvancedMockChatMessageHistory)
```


### func [WithHistoryDelay](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L303)

```go
func WithHistoryDelay(delay time.Duration) MockHistoryOption
```

WithHistoryDelay adds artificial delay to mock operations.


### func [WithHistoryError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L295)

```go
func WithHistoryError(shouldError bool, err error) MockHistoryOption
```

WithHistoryError configures the mock to return errors.


### func [WithHistoryMaxSize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L288)

```go
func WithHistoryMaxSize(size int) MockHistoryOption
```

WithHistoryMaxSize sets the maximum history size.


### func [WithPreloadedHistoryMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L310)

```go
func WithPreloadedHistoryMessages(messages []schema.Message) MockHistoryOption
```

WithPreloadedHistoryMessages preloads messages into the mock history.


## type [MockMemoryOption](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L62)

MockMemoryOption defines functional options for mock configuration.

```go
type MockMemoryOption func(*AdvancedMockMemory)
```


### func [WithMaxMemorySize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L94)

```go
func WithMaxMemorySize(size int) MockMemoryOption
```

WithMaxMemorySize sets the maximum memory size.


### func [WithMemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L73)

```go
func WithMemoryVariables(variables []string) MockMemoryOption
```

WithMemoryVariables sets the memory variables for the mock.


### func [WithMockError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L65)

```go
func WithMockError(shouldError bool, err error) MockMemoryOption
```

WithMockError configures the mock to return errors.


### func [WithMockReturnMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L80)

```go
func WithMockReturnMessages(returnMessages bool) MockMemoryOption
```

WithMockReturnMessages sets whether to return messages directly.


### func [WithPreloadedMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L101)

```go
func WithPreloadedMessages(messages []schema.Message) MockMemoryOption
```

WithPreloadedMessages preloads messages into the mock.


### func [WithSimulateDelay](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/test_utils.go#L87)

```go
func WithSimulateDelay(delay time.Duration) MockMemoryOption
```

WithSimulateDelay adds artificial delay to mock operations.


## type [NoOpMemory](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L228)

NoOpMemory is a no\-op implementation of the Memory interface. It can be used when memory is disabled or for testing purposes.

```go
type NoOpMemory struct{}
```


### func \(\*NoOpMemory\) [Clear](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L246)

```go
func (m *NoOpMemory) Clear(ctx context.Context) error
```

Clear does nothing for no\-op memory.


### func \(\*NoOpMemory\) [LoadMemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L236)

```go
func (m *NoOpMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables returns an empty map for no\-op memory.


### func \(\*NoOpMemory\) [MemoryVariables](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L231)

```go
func (m *NoOpMemory) MemoryVariables() []string
```

MemoryVariables returns an empty slice for no\-op memory.


### func \(\*NoOpMemory\) [SaveContext](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/memory.go#L241)

```go
func (m *NoOpMemory) SaveContext(ctx context.Context, inputs, outputs map[string]any) error
```

SaveContext does nothing for no\-op memory.


## type [Option](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L72)

Option is a functional option for configuring memory implementations.

```go
type Option func(*Config)
```


### func [WithAIPrefix](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L131)

```go
func WithAIPrefix(prefix string) Option
```

WithAIPrefix sets the AI message prefix.


### func [WithHumanPrefix](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L124)

```go
func WithHumanPrefix(prefix string) Option
```

WithHumanPrefix sets the human message prefix.


### func [WithInputKey](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L82)

```go
func WithInputKey(key string) Option
```

WithInputKey sets the input key.


### func [WithMaxTokenLimit](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L110)

```go
func WithMaxTokenLimit(limit int) Option
```

WithMaxTokenLimit sets the maximum token limit for summary memories.


### func [WithMemoryKey](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L75)

```go
func WithMemoryKey(key string) Option
```

WithMemoryKey sets the memory key.


### func [WithOutputKey](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L89)

```go
func WithOutputKey(key string) Option
```

WithOutputKey sets the output key.


### func [WithReturnMessages](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L96)

```go
func WithReturnMessages(returnMessages bool) Option
```

WithReturnMessages sets whether to return messages directly.


### func [WithTimeout](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L138)

```go
func WithTimeout(timeout time.Duration) Option
```

WithTimeout sets the timeout for operations.


### func [WithTopK](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L117)

```go
func WithTopK(k int) Option
```

WithTopK sets the number of documents to retrieve.


### func [WithWindowSize](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L103)

```go
func WithWindowSize(size int) Option
```

WithWindowSize sets the window size for window\-based memories.


## type [SummaryConfig](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L59-L63)

SummaryConfig holds configuration specific to summary memory implementations.

```go
type SummaryConfig struct {
    ChatHistory ChatMessageHistory
    LLM         core.Runnable
    Config      `mapstructure:",squash"`
}
```


## type [Tracer](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L150-L152)

Tracer provides tracing functionality for memory operations.

```go
type Tracer struct {
    // contains filtered or unexported fields
}
```


### func [GetGlobalTracer](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L204)

```go
func GetGlobalTracer() *Tracer
```

GetGlobalTracer returns the global tracer instance.


### func [NewTracer](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L155)

```go
func NewTracer() *Tracer
```

NewTracer creates a new Tracer instance.


### func \(\*Tracer\) [RecordSpanError](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L173)

```go
func (t *Tracer) RecordSpanError(span trace.Span, err error)
```

RecordSpanError records an error on the span.


### func \(\*Tracer\) [StartSpan](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/metrics.go#L164)

```go
func (t *Tracer) StartSpan(ctx context.Context, operation string, memoryType MemoryType, memoryKey string) (context.Context, trace.Span)
```

StartSpan starts a new span for a memory operation.


## type [VectorStoreConfig](https://github.com/lookatitude/beluga-ai/blob/main/pkg/memory/config.go#L66-L69)

VectorStoreConfig holds configuration specific to vector store memory implementations.

```go
type VectorStoreConfig struct {
    Retriever core.Retriever
    Config    `mapstructure:",squash"`
}
```

Generated by [gomarkdoc](https://github.com/princjef/gomarkdoc)
