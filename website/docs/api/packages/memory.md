<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# memory

```go
import "github.com/lookatitude/beluga-ai/memory"
```

Package memory defines interfaces and implementations for managing conversation history. Memory components allow agents and chains to retain information about past interactions.

Package memory provides interfaces and implementations for managing conversation history.

Package memory provides interfaces and implementations for managing conversation history.

Package memory provides interfaces and implementations for managing conversation history.

Package memory provides interfaces and implementations for managing conversation history.

Package memory provides interfaces and implementations for managing conversation history.

## Index

- [Variables](<#variables>)
- [func GetBufferString\(messages \[\]schema.Message, humanPrefix string, aiPrefix string\) string](<#GetBufferString>)
- [func GetInputOutputKeys\(inputs map\[string\]any, outputs map\[string\]any\) \(inputKey, outputKey string, err error\)](<#GetInputOutputKeys>)
- [type BaseMemory](<#BaseMemory>)
- [type ChatMessageHistory](<#ChatMessageHistory>)
- [type ConversationBufferMemory](<#ConversationBufferMemory>)
  - [func NewConversationBufferMemory\(history ChatMessageHistory, memoryKey string, returnMessages bool\) \*ConversationBufferMemory](<#NewConversationBufferMemory>)
  - [func \(m \*ConversationBufferMemory\) Clear\(ctx context.Context\) error](<#ConversationBufferMemory.Clear>)
  - [func \(m \*ConversationBufferMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](<#ConversationBufferMemory.LoadMemoryVariables>)
  - [func \(m \*ConversationBufferMemory\) MemoryVariables\(\) \[\]string](<#ConversationBufferMemory.MemoryVariables>)
  - [func \(m \*ConversationBufferMemory\) SaveContext\(ctx context.Context, inputs map\[string\]any, outputs map\[string\]any\) error](<#ConversationBufferMemory.SaveContext>)
- [type ConversationBufferWindowMemory](<#ConversationBufferWindowMemory>)
  - [func NewConversationBufferWindowMemory\(history ChatMessageHistory, k int, memoryKey string, returnMessages bool\) \*ConversationBufferWindowMemory](<#NewConversationBufferWindowMemory>)
  - [func \(m \*ConversationBufferWindowMemory\) Clear\(ctx context.Context\) error](<#ConversationBufferWindowMemory.Clear>)
  - [func \(m \*ConversationBufferWindowMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](<#ConversationBufferWindowMemory.LoadMemoryVariables>)
  - [func \(m \*ConversationBufferWindowMemory\) MemoryVariables\(\) \[\]string](<#ConversationBufferWindowMemory.MemoryVariables>)
  - [func \(m \*ConversationBufferWindowMemory\) SaveContext\(ctx context.Context, inputs map\[string\]any, outputs map\[string\]any\) error](<#ConversationBufferWindowMemory.SaveContext>)
- [type ConversationSummaryBufferMemory](<#ConversationSummaryBufferMemory>)
  - [func NewConversationSummaryBufferMemory\(history ChatMessageHistory, llm llms.LLM, memoryKey string, maxTokenLimit int\) \*ConversationSummaryBufferMemory](<#NewConversationSummaryBufferMemory>)
  - [func \(m \*ConversationSummaryBufferMemory\) Clear\(ctx context.Context\) error](<#ConversationSummaryBufferMemory.Clear>)
  - [func \(m \*ConversationSummaryBufferMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](<#ConversationSummaryBufferMemory.LoadMemoryVariables>)
  - [func \(m \*ConversationSummaryBufferMemory\) MemoryVariables\(\) \[\]string](<#ConversationSummaryBufferMemory.MemoryVariables>)
  - [func \(m \*ConversationSummaryBufferMemory\) SaveContext\(ctx context.Context, inputs map\[string\]any, outputs map\[string\]any\) error](<#ConversationSummaryBufferMemory.SaveContext>)
- [type ConversationSummaryMemory](<#ConversationSummaryMemory>)
  - [func NewConversationSummaryMemory\(history ChatMessageHistory, llm llms.LLM, memoryKey string\) \*ConversationSummaryMemory](<#NewConversationSummaryMemory>)
  - [func \(m \*ConversationSummaryMemory\) Clear\(ctx context.Context\) error](<#ConversationSummaryMemory.Clear>)
  - [func \(m \*ConversationSummaryMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](<#ConversationSummaryMemory.LoadMemoryVariables>)
  - [func \(m \*ConversationSummaryMemory\) MemoryVariables\(\) \[\]string](<#ConversationSummaryMemory.MemoryVariables>)
  - [func \(m \*ConversationSummaryMemory\) SaveContext\(ctx context.Context, inputs map\[string\]any, outputs map\[string\]any\) error](<#ConversationSummaryMemory.SaveContext>)
- [type SimpleChatMessageHistory](<#SimpleChatMessageHistory>)
  - [func NewSimpleChatMessageHistory\(\) \*SimpleChatMessageHistory](<#NewSimpleChatMessageHistory>)
  - [func \(h \*SimpleChatMessageHistory\) AddAIMessage\(ctx context.Context, message string\) error](<#SimpleChatMessageHistory.AddAIMessage>)
  - [func \(h \*SimpleChatMessageHistory\) AddMessage\(ctx context.Context, message schema.Message\) error](<#SimpleChatMessageHistory.AddMessage>)
  - [func \(h \*SimpleChatMessageHistory\) AddUserMessage\(ctx context.Context, message string\) error](<#SimpleChatMessageHistory.AddUserMessage>)
  - [func \(h \*SimpleChatMessageHistory\) Clear\(ctx context.Context\) error](<#SimpleChatMessageHistory.Clear>)
  - [func \(h \*SimpleChatMessageHistory\) GetMessages\(ctx context.Context\) \(\[\]schema.Message, error\)](<#SimpleChatMessageHistory.GetMessages>)
- [type VectorStoreMemory](<#VectorStoreMemory>)
  - [func NewVectorStoreMemory\(retriever rag.Retriever, memoryKey string, returnDocs bool, k int\) \*VectorStoreMemory](<#NewVectorStoreMemory>)
  - [func \(m \*VectorStoreMemory\) Clear\(ctx context.Context\) error](<#VectorStoreMemory.Clear>)
  - [func \(m \*VectorStoreMemory\) LoadMemoryVariables\(ctx context.Context, inputs map\[string\]any\) \(map\[string\]any, error\)](<#VectorStoreMemory.LoadMemoryVariables>)
  - [func \(m \*VectorStoreMemory\) MemoryVariables\(\) \[\]string](<#VectorStoreMemory.MemoryVariables>)
  - [func \(m \*VectorStoreMemory\) SaveContext\(ctx context.Context, inputs map\[string\]any, outputs map\[string\]any\) error](<#VectorStoreMemory.SaveContext>)


## Variables

<a name="DefaultSummaryPrompt"></a>DefaultSummaryPrompt is a basic prompt template for summarizing conversations. Corrected to use NewStringPromptTemplate

```go
var DefaultSummaryPrompt = prompts.NewStringPromptTemplate(
    "Progressively summarize the lines of conversation provided, adding onto the previous summary returning a new summary.\n\nEXAMPLE\nCurrent summary:\nThe human asks what the AI thinks of artificial intelligence. The AI thinks artificial intelligence is a force for good.\n\nNew lines of conversation:\nHuman: Why do you think artificial intelligence is a force for good?\nAI: Because artificial intelligence will help humans reach their full potential.\n\nNew summary:\nThe human asks what the AI thinks of artificial intelligence. The AI thinks artificial intelligence is a force for good because it will help humans reach their full potential.\nEND OF EXAMPLE\n\nCurrent summary:\n{{.summary}}\n\nNew lines of conversation:\n{{.new_lines}}\n\nNew summary:",
)
```

<a name="GetBufferString"></a>
## func GetBufferString

```go
func GetBufferString(messages []schema.Message, humanPrefix string, aiPrefix string) string
```

GetBufferString formats a slice of chat messages into a single string. It includes prefixes for Human and AI messages.

<a name="GetInputOutputKeys"></a>
## func GetInputOutputKeys

```go
func GetInputOutputKeys(inputs map[string]any, outputs map[string]any) (inputKey, outputKey string, err error)
```

GetInputOutputKeys extracts the input and output keys from the provided maps. It assumes single input and output keys if not specified in the memory object. TODO: Make this more robust, potentially using memory configuration.

<a name="BaseMemory"></a>
## type BaseMemory

BaseMemory defines the interface for all memory types. It specifies how memory variables are loaded and saved.

```go
type BaseMemory interface {
    // MemoryVariables returns the list of variable names that this memory class will load
    // and make available to the prompt/chain/agent.
    MemoryVariables() []string

    // LoadMemoryVariables retrieves the context/history associated with the given input variables
    // and returns them as a map suitable for prompt formatting.
    // The `inputs` map might be used by some memory types to determine the context (e.g., session ID).
    LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)

    // SaveContext updates the memory state based on the inputs provided by the user
    // and the outputs generated by the model/chain.
    SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error

    // Clear completely wipes the memory state.
    Clear(ctx context.Context) error
}
```

<a name="ChatMessageHistory"></a>
## type ChatMessageHistory

ChatMessageHistory defines the interface for storing a sequence of chat messages. This is often used as the underlying storage mechanism for various chat memory types.

```go
type ChatMessageHistory interface {
    // AddUserMessage adds a message from the user (HumanMessage).
    AddUserMessage(ctx context.Context, message string) error
    // AddAIMessage adds a message from the AI (AIMessage).
    AddAIMessage(ctx context.Context, message string) error
    // AddMessage adds an arbitrary message object.
    AddMessage(ctx context.Context, message schema.Message) error
    // GetMessages retrieves all messages stored in the history.
    GetMessages(ctx context.Context) ([]schema.Message, error)
    // Clear removes all messages from the history.
    Clear(ctx context.Context) error
}
```

<a name="ConversationBufferMemory"></a>
## type ConversationBufferMemory

ConversationBufferMemory remembers the entire conversation history. It loads the history into a single variable \("history" by default\).

```go
type ConversationBufferMemory struct {
    ChatHistory    ChatMessageHistory // Underlying storage for messages
    MemoryKey      string             // Key name for the history variable in prompts
    InputKey       string             // Key name for the user input variable (optional, used in SaveContext)
    OutputKey      string             // Key name for the AI output variable (optional, used in SaveContext)
    HumanPrefix    string             // Prefix for human messages in the buffer string
    AiPrefix       string             // Prefix for AI messages in the buffer string
    ReturnMessages bool               // If true, LoadMemoryVariables returns []schema.Message, otherwise a formatted string
}
```

<a name="NewConversationBufferMemory"></a>
### func NewConversationBufferMemory

```go
func NewConversationBufferMemory(history ChatMessageHistory, memoryKey string, returnMessages bool) *ConversationBufferMemory
```

NewConversationBufferMemory creates a new ConversationBufferMemory.

<a name="ConversationBufferMemory.Clear"></a>
### func \(\*ConversationBufferMemory\) Clear

```go
func (m *ConversationBufferMemory) Clear(ctx context.Context) error
```

Clear removes all messages from the underlying chat history.

<a name="ConversationBufferMemory.LoadMemoryVariables"></a>
### func \(\*ConversationBufferMemory\) LoadMemoryVariables

```go
func (m *ConversationBufferMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables retrieves the conversation history. It returns either a formatted string or a slice of messages based on ReturnMessages.

<a name="ConversationBufferMemory.MemoryVariables"></a>
### func \(\*ConversationBufferMemory\) MemoryVariables

```go
func (m *ConversationBufferMemory) MemoryVariables() []string
```

MemoryVariables returns the key used for the conversation history.

<a name="ConversationBufferMemory.SaveContext"></a>
### func \(\*ConversationBufferMemory\) SaveContext

```go
func (m *ConversationBufferMemory) SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error
```

SaveContext adds the latest user input and AI output to the chat history.

<a name="ConversationBufferWindowMemory"></a>
## type ConversationBufferWindowMemory

ConversationBufferWindowMemory remembers a fixed number of the most recent interactions. It loads the history into a single variable \("history" by default\).

```go
type ConversationBufferWindowMemory struct {
    ChatHistory    ChatMessageHistory // Underlying storage for messages
    K              int                // Number of messages to keep in the window
    MemoryKey      string             // Key name for the history variable in prompts
    InputKey       string             // Key name for the user input variable (optional, used in SaveContext)
    OutputKey      string             // Key name for the AI output variable (optional, used in SaveContext)
    HumanPrefix    string             // Prefix for human messages in the buffer string
    AiPrefix       string             // Prefix for AI messages in the buffer string
    ReturnMessages bool               // If true, LoadMemoryVariables returns []schema.Message, otherwise a formatted string
}
```

<a name="NewConversationBufferWindowMemory"></a>
### func NewConversationBufferWindowMemory

```go
func NewConversationBufferWindowMemory(history ChatMessageHistory, k int, memoryKey string, returnMessages bool) *ConversationBufferWindowMemory
```

NewConversationBufferWindowMemory creates a new ConversationBufferWindowMemory.

<a name="ConversationBufferWindowMemory.Clear"></a>
### func \(\*ConversationBufferWindowMemory\) Clear

```go
func (m *ConversationBufferWindowMemory) Clear(ctx context.Context) error
```

Clear removes all messages from the underlying chat history.

<a name="ConversationBufferWindowMemory.LoadMemoryVariables"></a>
### func \(\*ConversationBufferWindowMemory\) LoadMemoryVariables

```go
func (m *ConversationBufferWindowMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables retrieves the conversation history, pruned to the window size \(K\). It returns either a formatted string or a slice of messages based on ReturnMessages.

<a name="ConversationBufferWindowMemory.MemoryVariables"></a>
### func \(\*ConversationBufferWindowMemory\) MemoryVariables

```go
func (m *ConversationBufferWindowMemory) MemoryVariables() []string
```

MemoryVariables returns the key used for the conversation history.

<a name="ConversationBufferWindowMemory.SaveContext"></a>
### func \(\*ConversationBufferWindowMemory\) SaveContext

```go
func (m *ConversationBufferWindowMemory) SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error
```

SaveContext adds the latest user input and AI output to the chat history. Pruning happens during loading, not saving.

<a name="ConversationSummaryBufferMemory"></a>
## type ConversationSummaryBufferMemory

ConversationSummaryBufferMemory combines buffer memory with summarization. It keeps a buffer of recent interactions and summarizes older ones using an LLM.

```go
type ConversationSummaryBufferMemory struct {
    ChatHistory   ChatMessageHistory     // Underlying storage for all messages
    LLM           llms.LLM               // LLM used for generating summaries
    SummaryPrompt prompts.PromptTemplate // Prompt template used for summarization
    MemoryKey     string                 // Key name for the combined history/summary variable
    InputKey      string                 // Key name for the user input variable (optional)
    OutputKey     string                 // Key name for the AI output variable (optional)
    HumanPrefix   string                 // Prefix for human messages
    AiPrefix      string                 // Prefix for AI messages
    MaxTokenLimit int                    // Maximum number of tokens before summarizing
    // contains filtered or unexported fields
}
```

<a name="NewConversationSummaryBufferMemory"></a>
### func NewConversationSummaryBufferMemory

```go
func NewConversationSummaryBufferMemory(history ChatMessageHistory, llm llms.LLM, memoryKey string, maxTokenLimit int) *ConversationSummaryBufferMemory
```

NewConversationSummaryBufferMemory creates a new ConversationSummaryBufferMemory.

<a name="ConversationSummaryBufferMemory.Clear"></a>
### func \(\*ConversationSummaryBufferMemory\) Clear

```go
func (m *ConversationSummaryBufferMemory) Clear(ctx context.Context) error
```

Clear resets the summary and clears the underlying chat history.

<a name="ConversationSummaryBufferMemory.LoadMemoryVariables"></a>
### func \(\*ConversationSummaryBufferMemory\) LoadMemoryVariables

```go
func (m *ConversationSummaryBufferMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables returns the relevant history \(summary \+ recent buffer\).

<a name="ConversationSummaryBufferMemory.MemoryVariables"></a>
### func \(\*ConversationSummaryBufferMemory\) MemoryVariables

```go
func (m *ConversationSummaryBufferMemory) MemoryVariables() []string
```

MemoryVariables returns the key used for the conversation history/summary.

<a name="ConversationSummaryBufferMemory.SaveContext"></a>
### func \(\*ConversationSummaryBufferMemory\) SaveContext

```go
func (m *ConversationSummaryBufferMemory) SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error
```

SaveContext adds the latest user input and AI output to the history. It potentially triggers summarization if the buffer exceeds the token limit.

<a name="ConversationSummaryMemory"></a>
## type ConversationSummaryMemory

ConversationSummaryMemory summarizes the conversation history over time. It keeps a running summary and uses an LLM to condense new interactions into it.

```go
type ConversationSummaryMemory struct {
    ChatHistory   ChatMessageHistory     // Underlying storage for messages (used temporarily before summarization)
    LLM           llms.LLM               // LLM used for generating summaries
    SummaryPrompt prompts.PromptTemplate // Prompt template used for summarization
    MemoryKey     string                 // Key name for the summary variable in prompts
    InputKey      string                 // Key name for the user input variable (optional, used in SaveContext)
    OutputKey     string                 // Key name for the AI output variable (optional, used in SaveContext)
    HumanPrefix   string                 // Prefix for human messages when creating new lines for summary prompt
    AiPrefix      string                 // Prefix for AI messages when creating new lines for summary prompt
    // contains filtered or unexported fields
}
```

<a name="NewConversationSummaryMemory"></a>
### func NewConversationSummaryMemory

```go
func NewConversationSummaryMemory(history ChatMessageHistory, llm llms.LLM, memoryKey string) *ConversationSummaryMemory
```

NewConversationSummaryMemory creates a new ConversationSummaryMemory.

<a name="ConversationSummaryMemory.Clear"></a>
### func \(\*ConversationSummaryMemory\) Clear

```go
func (m *ConversationSummaryMemory) Clear(ctx context.Context) error
```

Clear resets the summary and clears the underlying chat history.

<a name="ConversationSummaryMemory.LoadMemoryVariables"></a>
### func \(\*ConversationSummaryMemory\) LoadMemoryVariables

```go
func (m *ConversationSummaryMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables returns the current conversation summary.

<a name="ConversationSummaryMemory.MemoryVariables"></a>
### func \(\*ConversationSummaryMemory\) MemoryVariables

```go
func (m *ConversationSummaryMemory) MemoryVariables() []string
```

MemoryVariables returns the key used for the conversation summary.

<a name="ConversationSummaryMemory.SaveContext"></a>
### func \(\*ConversationSummaryMemory\) SaveContext

```go
func (m *ConversationSummaryMemory) SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error
```

SaveContext adds the latest user input and AI output, then updates the summary.

<a name="SimpleChatMessageHistory"></a>
## type SimpleChatMessageHistory

SimpleChatMessageHistory provides a basic in\-memory implementation of ChatMessageHistory. It stores messages in a simple slice.

```go
type SimpleChatMessageHistory struct {
    Messages []schema.Message
    // contains filtered or unexported fields
}
```

<a name="NewSimpleChatMessageHistory"></a>
### func NewSimpleChatMessageHistory

```go
func NewSimpleChatMessageHistory() *SimpleChatMessageHistory
```

NewSimpleChatMessageHistory creates a new SimpleChatMessageHistory.

<a name="SimpleChatMessageHistory.AddAIMessage"></a>
### func \(\*SimpleChatMessageHistory\) AddAIMessage

```go
func (h *SimpleChatMessageHistory) AddAIMessage(ctx context.Context, message string) error
```

AddAIMessage adds an AIMessage to the history.

<a name="SimpleChatMessageHistory.AddMessage"></a>
### func \(\*SimpleChatMessageHistory\) AddMessage

```go
func (h *SimpleChatMessageHistory) AddMessage(ctx context.Context, message schema.Message) error
```

AddMessage adds any schema.Message to the history.

<a name="SimpleChatMessageHistory.AddUserMessage"></a>
### func \(\*SimpleChatMessageHistory\) AddUserMessage

```go
func (h *SimpleChatMessageHistory) AddUserMessage(ctx context.Context, message string) error
```

AddUserMessage adds a HumanMessage to the history.

<a name="SimpleChatMessageHistory.Clear"></a>
### func \(\*SimpleChatMessageHistory\) Clear

```go
func (h *SimpleChatMessageHistory) Clear(ctx context.Context) error
```

Clear removes all messages from the history.

<a name="SimpleChatMessageHistory.GetMessages"></a>
### func \(\*SimpleChatMessageHistory\) GetMessages

```go
func (h *SimpleChatMessageHistory) GetMessages(ctx context.Context) ([]schema.Message, error)
```

GetMessages returns all messages in the history.

<a name="VectorStoreMemory"></a>
## type VectorStoreMemory

VectorStoreMemory uses a vector store to retrieve relevant context from past interactions. It embeds the input/output and stores it, then retrieves similar documents during loading.

```go
type VectorStoreMemory struct {
    Retriever     rag.Retriever // Retriever interface (often backed by a VectorStore + Embedder)
    MemoryKey     string        // Key name for the retrieved documents variable in prompts
    InputKey      string        // Key name for the user input variable (used for retrieval query and saving)
    OutputKey     string        // Key name for the AI output variable (used for saving)
    ReturnDocs    bool          // If true, LoadMemoryVariables returns []schema.Document, otherwise a formatted string
    NumDocsToKeep int           // Number of relevant documents to retrieve

}
```

<a name="NewVectorStoreMemory"></a>
### func NewVectorStoreMemory

```go
func NewVectorStoreMemory(retriever rag.Retriever, memoryKey string, returnDocs bool, k int) *VectorStoreMemory
```

NewVectorStoreMemory creates a new VectorStoreMemory.

<a name="VectorStoreMemory.Clear"></a>
### func \(\*VectorStoreMemory\) Clear

```go
func (m *VectorStoreMemory) Clear(ctx context.Context) error
```

Clear might be a no\-op for vector store memory, as clearing might affect other uses. Alternatively, it could attempt to delete documents associated with a specific session ID if implemented.

<a name="VectorStoreMemory.LoadMemoryVariables"></a>
### func \(\*VectorStoreMemory\) LoadMemoryVariables

```go
func (m *VectorStoreMemory) LoadMemoryVariables(ctx context.Context, inputs map[string]any) (map[string]any, error)
```

LoadMemoryVariables retrieves documents relevant to the current input.

<a name="VectorStoreMemory.MemoryVariables"></a>
### func \(\*VectorStoreMemory\) MemoryVariables

```go
func (m *VectorStoreMemory) MemoryVariables() []string
```

MemoryVariables returns the key used for the retrieved documents.

<a name="VectorStoreMemory.SaveContext"></a>
### func \(\*VectorStoreMemory\) SaveContext

```go
func (m *VectorStoreMemory) SaveContext(ctx context.Context, inputs map[string]any, outputs map[string]any) error
```

SaveContext embeds the input/output pair and saves it to the vector store.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
