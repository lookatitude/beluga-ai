---
title: retrievers
sidebar_position: 1
---

<!-- Code generated by gomarkdoc. DO NOT EDIT -->


# retrievers

```go
import "github.com/lookatitude/beluga-ai/pkg/retrievers"
```

Package retrievers provides configuration structs for retriever components.

Package retrievers provides custom error types for the retrievers package.

Package retrievers provides metrics collection for retriever operations.

Package retrievers provides implementations of the core.Retriever interface.

Package retrievers provides implementations of retrieval components for RAG (Retrieval Augmented Generation) pipelines.

This package offers:

- VectorStoreRetriever: Retrieves documents from vector stores using similarity search
- Configuration management with validation
- OpenTelemetry integration for metrics and tracing
- Custom error types for better error handling
- Functional options pattern for flexible configuration

Basic usage:

```
import "github.com/lookatitude/beluga-ai/pkg/retrievers"

// Create a vector store retriever
:= retrievers.NewVectorStoreRetriever(vectorStore,
    retrievers.WithDefaultK(5),
    retrievers.WithScoreThreshold(0.7),
)

// Retrieve documents
docs, err := retriever.GetRelevantDocuments(ctx, "What is machine learning?")
```

Extensibility:

The package is designed to be easily extensible:

- Add new retriever implementations in the providers/ directory
- Implement custom retrievers by implementing the core.Retriever interface
- Add new configuration options using the functional options pattern
- Extend metrics collection for new retriever types

Package retrievers provides advanced test utilities and comprehensive mocks for testing retriever implementations. This file contains utilities designed to support both unit tests and integration tests.

Package retrievers provides implementations of the core.Retriever interface.

## Index

- [Constants](<#constants>)
- [`func AssertErrorType(t *testing.T, err error, expectedCode string)`](<#AssertErrorType>)
- [`func AssertRetrievalRelevance(t *testing.T, documents []schema.Document, query string, minRelevance float32)`](<#AssertRetrievalRelevance>)
- [`func AssertRetrievalResults(t *testing.T, documents []schema.Document, expectedMinCount, expectedMaxCount int)`](<#AssertRetrievalResults>)
- [`func AssertRetrieverHealth(t *testing.T, health map[string]any, expectedStatus string)`](<#AssertRetrieverHealth>)
- [`func CalculateRelevanceScore(query, docContent string) float32`](<#CalculateRelevanceScore>)
- [`func CreateTestRetrievalDocuments(count int) []schema.Document`](<#CreateTestRetrievalDocuments>)
- [`func CreateTestRetrievalQueries(count int) []string`](<#CreateTestRetrievalQueries>)
- [`func GetRetrieverTypes() []string`](<#GetRetrieverTypes>)
- [`func InitMetrics(meter metric.Meter, tracer trace.Tracer)`](<#InitMetrics>)
- [`func RunLoadTest(t *testing.T, retriever *AdvancedMockRetriever, numOperations, concurrency int)`](<#RunLoadTest>)
- [`func ValidateRetrieverConfig(config Config) error`](<#ValidateRetrieverConfig>)
- [type AdvancedMockRetriever](<#AdvancedMockRetriever>)
  - [`func NewAdvancedMockRetriever(name, retrieverType string, options ...MockRetrieverOption) *AdvancedMockRetriever`](<#NewAdvancedMockRetriever>)
  - [`func (r *AdvancedMockRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)`](<#AdvancedMockRetriever.Batch>)
  - [`func (r *AdvancedMockRetriever) CheckHealth() map[string]any`](<#AdvancedMockRetriever.CheckHealth>)
  - [`func (r *AdvancedMockRetriever) GetCallCount() int`](<#AdvancedMockRetriever.GetCallCount>)
  - [`func (r *AdvancedMockRetriever) GetDocumentCount() int`](<#AdvancedMockRetriever.GetDocumentCount>)
  - [`func (r *AdvancedMockRetriever) GetName() string`](<#AdvancedMockRetriever.GetName>)
  - [`func (r *AdvancedMockRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)`](<#AdvancedMockRetriever.GetRelevantDocuments>)
  - [`func (r *AdvancedMockRetriever) GetType() string`](<#AdvancedMockRetriever.GetType>)
  - [`func (r *AdvancedMockRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)`](<#AdvancedMockRetriever.Invoke>)
  - [`func (r *AdvancedMockRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)`](<#AdvancedMockRetriever.Stream>)
- [type AdvancedMockVectorStoreRetriever](<#AdvancedMockVectorStoreRetriever>)
  - [`func NewAdvancedMockVectorStoreRetriever(name string, options ...MockRetrieverOption) *AdvancedMockVectorStoreRetriever`](<#NewAdvancedMockVectorStoreRetriever>)
  - [`func (r *AdvancedMockVectorStoreRetriever) GetEmbedder() any`](<#AdvancedMockVectorStoreRetriever.GetEmbedder>)
  - [`func (r *AdvancedMockVectorStoreRetriever) GetVectorStore() any`](<#AdvancedMockVectorStoreRetriever.GetVectorStore>)
  - [`func (r *AdvancedMockVectorStoreRetriever) SetEmbedder(embedder any)`](<#AdvancedMockVectorStoreRetriever.SetEmbedder>)
  - [`func (r *AdvancedMockVectorStoreRetriever) SetVectorStore(store any)`](<#AdvancedMockVectorStoreRetriever.SetVectorStore>)
- [type AdvancedMockcomponent](<#AdvancedMockcomponent>)
  - [`func NewAdvancedMockcomponent() *AdvancedMockcomponent`](<#NewAdvancedMockcomponent>)
- [type BenchmarkHelper](<#BenchmarkHelper>)
  - [`func NewBenchmarkHelper(retriever core.Retriever, queryCount int) *BenchmarkHelper`](<#NewBenchmarkHelper>)
  - [`func (b *BenchmarkHelper) BenchmarkBatchRetrieval(batchSize, iterations int) (time.Duration, error)`](<#BenchmarkHelper.BenchmarkBatchRetrieval>)
  - [`func (b *BenchmarkHelper) BenchmarkRetrieval(iterations int) (time.Duration, error)`](<#BenchmarkHelper.BenchmarkRetrieval>)
- [type ConcurrentTestRunner](<#ConcurrentTestRunner>)
  - [`func NewConcurrentTestRunner(numGoroutines int, duration time.Duration, testFunc func() error) *ConcurrentTestRunner`](<#NewConcurrentTestRunner>)
  - [`func (r *ConcurrentTestRunner) Run() error`](<#ConcurrentTestRunner.Run>)
- [type Config](<#Config>)
  - [`func DefaultConfig() Config`](<#DefaultConfig>)
  - [`func (c *Config) ApplyDefaults()`](<#Config.ApplyDefaults>)
  - [`func (c *Config) Validate() error`](<#Config.Validate>)
- [type DocumentScore](<#DocumentScore>)
  - [`func RankDocuments(query string, documents []schema.Document) []DocumentScore`](<#RankDocuments>)
- [type IntegrationTestHelper](<#IntegrationTestHelper>)
  - [`func NewIntegrationTestHelper() *IntegrationTestHelper`](<#NewIntegrationTestHelper>)
  - [`func (h *IntegrationTestHelper) AddEmbedder(name string, embedder any)`](<#IntegrationTestHelper.AddEmbedder>)
  - [`func (h *IntegrationTestHelper) AddRetriever(name string, retriever *AdvancedMockRetriever)`](<#IntegrationTestHelper.AddRetriever>)
  - [`func (h *IntegrationTestHelper) AddVectorStore(name string, store any)`](<#IntegrationTestHelper.AddVectorStore>)
  - [`func (h *IntegrationTestHelper) GetEmbedder(name string) any`](<#IntegrationTestHelper.GetEmbedder>)
  - [`func (h *IntegrationTestHelper) GetRetriever(name string) *AdvancedMockRetriever`](<#IntegrationTestHelper.GetRetriever>)
  - [`func (h *IntegrationTestHelper) GetVectorStore(name string) any`](<#IntegrationTestHelper.GetVectorStore>)
  - [`func (h *IntegrationTestHelper) Reset()`](<#IntegrationTestHelper.Reset>)
- [type Metrics](<#Metrics>)
  - [`func GetMetrics() *Metrics`](<#GetMetrics>)
  - [`func NewMetrics(meter metric.Meter, tracer trace.Tracer) (*Metrics, error)`](<#NewMetrics>)
  - [`func (m *Metrics) RecordBatchOperation(ctx context.Context, operation string, batchSize int, duration time.Duration)`](<#Metrics.RecordBatchOperation>)
  - [`func (m *Metrics) RecordEmbeddingDimension(ctx context.Context, dimension int)`](<#Metrics.RecordEmbeddingDimension>)
  - [`func (m *Metrics) RecordRetrieval(ctx context.Context, retrieverType string, duration time.Duration, documentCount int, avgScore float64, err error)`](<#Metrics.RecordRetrieval>)
  - [`func (m *Metrics) RecordVectorStoreOperation(ctx context.Context, operation string, duration time.Duration, documentCount int, err error)`](<#Metrics.RecordVectorStoreOperation>)
- [type MockRetrieverOption](<#MockRetrieverOption>)
  - [`func WithErrorCode(errorCode string) MockRetrieverOption`](<#WithErrorCode>)
  - [`func WithErrorType(err error) MockRetrieverOption`](<#WithErrorType>)
  - [`func WithMockDefaultK(k int) MockRetrieverOption`](<#WithMockDefaultK>)
  - [`func WithMockDelay(delay time.Duration) MockRetrieverOption`](<#WithMockDelay>)
  - [`func WithMockDocuments(documents []schema.Document) MockRetrieverOption`](<#WithMockDocuments>)
  - [`func WithMockError(shouldError bool, err error) MockRetrieverOption`](<#WithMockError>)
  - [`func WithMockScores(scores []float32) MockRetrieverOption`](<#WithMockScores>)
  - [`func WithScoreThreshold(threshold float32) MockRetrieverOption`](<#WithScoreThreshold>)
- [type MultiQueryRetriever](<#MultiQueryRetriever>)
  - [`func NewMultiQueryRetriever(opts *MultiQueryRetrieverOptions) (*MultiQueryRetriever, error)`](<#NewMultiQueryRetriever>)
  - [`func (m *MultiQueryRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)`](<#MultiQueryRetriever.Batch>)
  - [`func (m *MultiQueryRetriever) CheckHealth(ctx context.Context) error`](<#MultiQueryRetriever.CheckHealth>)
  - [`func (m *MultiQueryRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)`](<#MultiQueryRetriever.GetRelevantDocuments>)
  - [`func (m *MultiQueryRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)`](<#MultiQueryRetriever.Invoke>)
  - [`func (m *MultiQueryRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)`](<#MultiQueryRetriever.Stream>)
- [type MultiQueryRetrieverOptions](<#MultiQueryRetrieverOptions>)
- [type Option](<#Option>)
  - [`func WithDefaultK(k int) Option`](<#WithDefaultK>)
  - [`func WithLogger(logger *slog.Logger) Option`](<#WithLogger>)
  - [`func WithMaxRetries(retries int) Option`](<#WithMaxRetries>)
  - [`func WithMeter(meter metric.Meter) Option`](<#WithMeter>)
  - [`func WithMetrics(enabled bool) Option`](<#WithMetrics>)
  - [`func WithTimeout(timeout time.Duration) Option`](<#WithTimeout>)
  - [`func WithTracer(tracer trace.Tracer) Option`](<#WithTracer>)
  - [`func WithTracing(enabled bool) Option`](<#WithTracing>)
- [type QueryDocumentPair](<#QueryDocumentPair>)
- [type Retriever](<#Retriever>)
- [type RetrieverError](<#RetrieverError>)
  - [`func NewRetrieverError(op string, err error, code string) *RetrieverError`](<#NewRetrieverError>)
  - [`func NewRetrieverErrorWithMessage(op string, err error, code, message string) *RetrieverError`](<#NewRetrieverErrorWithMessage>)
  - [`func (e *RetrieverError) Error() string`](<#RetrieverError.Error>)
  - [`func (e *RetrieverError) Unwrap() error`](<#RetrieverError.Unwrap>)
- [type RetrieverOptions](<#RetrieverOptions>)
  - [`func CreateTestRetrieverConfig() RetrieverOptions`](<#CreateTestRetrieverConfig>)
- [type RetrieverScenarioRunner](<#RetrieverScenarioRunner>)
  - [`func NewRetrieverScenarioRunner(retriever core.Retriever) *RetrieverScenarioRunner`](<#NewRetrieverScenarioRunner>)
  - [`func (r *RetrieverScenarioRunner) RunMultiQueryScenario(ctx context.Context, queries []string) ([][]schema.Document, error)`](<#RetrieverScenarioRunner.RunMultiQueryScenario>)
  - [`func (r *RetrieverScenarioRunner) RunRelevanceTestScenario(ctx context.Context, queryDocPairs []QueryDocumentPair) error`](<#RetrieverScenarioRunner.RunRelevanceTestScenario>)
- [type RetrieversMockcomponent](<#RetrieversMockcomponent>)
  - [`func NewRetrieversMockcomponent() *RetrieversMockcomponent`](<#NewRetrieversMockcomponent>)
- [type TimeoutError](<#TimeoutError>)
  - [`func NewTimeoutError(op string, timeout time.Duration, err error) *TimeoutError`](<#NewTimeoutError>)
  - [`func (e *TimeoutError) Error() string`](<#TimeoutError.Error>)
  - [`func (e *TimeoutError) Unwrap() error`](<#TimeoutError.Unwrap>)
- [type ValidationError](<#ValidationError>)
  - [`func (e *ValidationError) Error() string`](<#ValidationError.Error>)
- [type VectorStoreConfig](<#VectorStoreConfig>)
  - [`func (c *VectorStoreConfig) ApplyDefaults()`](<#VectorStoreConfig.ApplyDefaults>)
  - [`func (c *VectorStoreConfig) Validate() error`](<#VectorStoreConfig.Validate>)
- [type VectorStoreRetriever](<#VectorStoreRetriever>)
  - [`func NewVectorStoreRetriever(vectorStore vectorstores.VectorStore, options ...Option) (*VectorStoreRetriever, error)`](<#NewVectorStoreRetriever>)
  - [`func NewVectorStoreRetrieverFromConfig(vectorStore vectorstores.VectorStore, config VectorStoreRetrieverConfig) (*VectorStoreRetriever, error)`](<#NewVectorStoreRetrieverFromConfig>)
  - [`func (r *VectorStoreRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)`](<#VectorStoreRetriever.Batch>)
  - [`func (r *VectorStoreRetriever) CheckHealth(ctx context.Context) error`](<#VectorStoreRetriever.CheckHealth>)
  - [`func (r *VectorStoreRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)`](<#VectorStoreRetriever.GetRelevantDocuments>)
  - [`func (r *VectorStoreRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)`](<#VectorStoreRetriever.Invoke>)
  - [`func (r *VectorStoreRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)`](<#VectorStoreRetriever.Stream>)
- [type VectorStoreRetrieverConfig](<#VectorStoreRetrieverConfig>)
  - [`func DefaultVectorStoreRetrieverConfig() VectorStoreRetrieverConfig`](<#DefaultVectorStoreRetrieverConfig>)
  - [`func (c *VectorStoreRetrieverConfig) ApplyDefaults()`](<#VectorStoreRetrieverConfig.ApplyDefaults>)
  - [`func (c *VectorStoreRetrieverConfig) Validate() error`](<#VectorStoreRetrieverConfig.Validate>)

## Constants

<a name="ErrCodeInvalidConfig"></a>Error codes for programmatic error handling.

```go
const (
    ErrCodeInvalidConfig         = "invalid_config"
    ErrCodeInvalidInput          = "invalid_input"
    ErrCodeRetrievalFailed       = "retrieval_failed"
    ErrCodeEmbeddingFailed       = "embedding_failed"
    ErrCodeVectorStoreError      = "vector_store_error"
    ErrCodeTimeout               = "timeout"
    ErrCodeRateLimit             = "rate_limit"
    ErrCodeNetworkError          = "network_error"
    ErrCodeQueryGenerationFailed = "query_generation_failed"
)
```

<a name="AssertErrorType"></a>
## func [AssertErrorType](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L378>)

```go
func AssertErrorType(t *testing.T, err error, expectedCode string)
```

AssertErrorType validates error types and codes.

<a name="AssertRetrievalRelevance"></a>
## func [AssertRetrievalRelevance](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L355>)

```go
func AssertRetrievalRelevance(t *testing.T, documents []schema.Document, query string, minRelevance float32)
```

AssertRetrievalRelevance validates document relevance to query.

<a name="AssertRetrievalResults"></a>
## func [AssertRetrievalResults](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L341>)

```go
func AssertRetrievalResults(t *testing.T, documents []schema.Document, expectedMinCount, expectedMaxCount int)
```

AssertRetrievalResults validates retrieval results.

<a name="AssertRetrieverHealth"></a>
## func [AssertRetrieverHealth](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L368>)

```go
func AssertRetrieverHealth(t *testing.T, health map[string]any, expectedStatus string)
```

AssertRetrieverHealth validates retriever health check results.

<a name="CalculateRelevanceScore"></a>
## func [CalculateRelevanceScore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L609>)

```go
func CalculateRelevanceScore(query, docContent string) float32
```

CalculateRelevanceScore calculates a simple relevance score between query and document.

<a name="CreateTestRetrievalDocuments"></a>
## func [CreateTestRetrievalDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L301>)

```go
func CreateTestRetrievalDocuments(count int) []schema.Document
```

CreateTestRetrievalDocuments creates documents optimized for retrieval testing.

<a name="CreateTestRetrievalQueries"></a>
## func [CreateTestRetrievalQueries](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L288>)

```go
func CreateTestRetrievalQueries(count int) []string
```

CreateTestRetrievalQueries creates standardized test queries.

<a name="GetRetrieverTypes"></a>
## func [GetRetrieverTypes](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L291>)

```go
func GetRetrieverTypes() []string
```

GetRetrieverTypes returns a list of available retriever types.

<a name="InitMetrics"></a>
## func [InitMetrics](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L219>)

```go
func InitMetrics(meter metric.Meter, tracer trace.Tracer)
```

InitMetrics initializes the global metrics instance. This follows the standard pattern used across all Beluga AI packages.

<a name="RunLoadTest"></a>
## func [RunLoadTest](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L449>)

```go
func RunLoadTest(t *testing.T, retriever *AdvancedMockRetriever, numOperations, concurrency int)
```

RunLoadTest executes a load test scenario on retriever.

<a name="ValidateRetrieverConfig"></a>
## func [ValidateRetrieverConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L299>)

```go
func ValidateRetrieverConfig(config Config) error
```

ValidateRetrieverConfig validates a retriever configuration.

<a name="AdvancedMockRetriever"></a>
## type [AdvancedMockRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L22-L38>)

AdvancedMockRetriever provides a comprehensive mock implementation for testing.

```go
type AdvancedMockRetriever struct {
    mock.Mock
    // contains filtered or unexported fields
}
```

<a name="NewAdvancedMockRetriever"></a>
### func [NewAdvancedMockRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L41>)

```go
func NewAdvancedMockRetriever(name, retrieverType string, options ...MockRetrieverOption) *AdvancedMockRetriever
```

NewAdvancedMockRetriever creates a new advanced mock with configurable behavior.

<a name="AdvancedMockRetriever.Batch"></a>
### func (*AdvancedMockRetriever) [Batch](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L133>)

```go
func (r *AdvancedMockRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)
```

<a name="AdvancedMockRetriever.CheckHealth"></a>
### func (*AdvancedMockRetriever) [CheckHealth](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L241>)

```go
func (r *AdvancedMockRetriever) CheckHealth() map[string]any
```

<a name="AdvancedMockRetriever.GetCallCount"></a>
### func (*AdvancedMockRetriever) [GetCallCount](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L229>)

```go
func (r *AdvancedMockRetriever) GetCallCount() int
```

<a name="AdvancedMockRetriever.GetDocumentCount"></a>
### func (*AdvancedMockRetriever) [GetDocumentCount](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L235>)

```go
func (r *AdvancedMockRetriever) GetDocumentCount() int
```

<a name="AdvancedMockRetriever.GetName"></a>
### func (*AdvancedMockRetriever) [GetName](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L221>)

```go
func (r *AdvancedMockRetriever) GetName() string
```

<a name="AdvancedMockRetriever.GetRelevantDocuments"></a>
### func (*AdvancedMockRetriever) [GetRelevantDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L160>)

```go
func (r *AdvancedMockRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)
```

Mock implementation methods for Retriever interface.

<a name="AdvancedMockRetriever.GetType"></a>
### func (*AdvancedMockRetriever) [GetType](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L225>)

```go
func (r *AdvancedMockRetriever) GetType() string
```

<a name="AdvancedMockRetriever.Invoke"></a>
### func (*AdvancedMockRetriever) [Invoke](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L126>)

```go
func (r *AdvancedMockRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)
```

Mock implementation methods for core.Runnable interface.

<a name="AdvancedMockRetriever.Stream"></a>
### func (*AdvancedMockRetriever) [Stream](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L145>)

```go
func (r *AdvancedMockRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)
```

<a name="AdvancedMockVectorStoreRetriever"></a>
## type [AdvancedMockVectorStoreRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L256-L260>)

AdvancedMockVectorStoreRetriever provides a comprehensive mock for vector store retrievers.

```go
type AdvancedMockVectorStoreRetriever struct {
    *AdvancedMockRetriever
    // contains filtered or unexported fields
}
```

<a name="NewAdvancedMockVectorStoreRetriever"></a>
### func [NewAdvancedMockVectorStoreRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L262>)

```go
func NewAdvancedMockVectorStoreRetriever(name string, options ...MockRetrieverOption) *AdvancedMockVectorStoreRetriever
```

<a name="AdvancedMockVectorStoreRetriever.GetEmbedder"></a>
### func (*AdvancedMockVectorStoreRetriever) [GetEmbedder](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L277>)

```go
func (r *AdvancedMockVectorStoreRetriever) GetEmbedder() any
```

<a name="AdvancedMockVectorStoreRetriever.GetVectorStore"></a>
### func (*AdvancedMockVectorStoreRetriever) [GetVectorStore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L269>)

```go
func (r *AdvancedMockVectorStoreRetriever) GetVectorStore() any
```

<a name="AdvancedMockVectorStoreRetriever.SetEmbedder"></a>
### func (*AdvancedMockVectorStoreRetriever) [SetEmbedder](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L281>)

```go
func (r *AdvancedMockVectorStoreRetriever) SetEmbedder(embedder any)
```

<a name="AdvancedMockVectorStoreRetriever.SetVectorStore"></a>
### func (*AdvancedMockVectorStoreRetriever) [SetVectorStore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L273>)

```go
func (r *AdvancedMockVectorStoreRetriever) SetVectorStore(store any)
```

<a name="AdvancedMockcomponent"></a>
## type [AdvancedMockcomponent](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/advanced_mock.go#L8-L10>)

AdvancedMockcomponent is a mock implementation of Interface.

```go
type AdvancedMockcomponent struct {
    mock.Mock
}
```

<a name="NewAdvancedMockcomponent"></a>
### func [NewAdvancedMockcomponent](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/advanced_mock.go#L13>)

```go
func NewAdvancedMockcomponent() *AdvancedMockcomponent
```

NewAdvancedMockcomponent creates a new AdvancedMockcomponent.

<a name="BenchmarkHelper"></a>
## type [BenchmarkHelper](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L692-L695>)

BenchmarkHelper provides benchmarking utilities for retrievers.

```go
type BenchmarkHelper struct {
    // contains filtered or unexported fields
}
```

<a name="NewBenchmarkHelper"></a>
### func [NewBenchmarkHelper](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L697>)

```go
func NewBenchmarkHelper(retriever core.Retriever, queryCount int) *BenchmarkHelper
```

<a name="BenchmarkHelper.BenchmarkBatchRetrieval"></a>
### func (*BenchmarkHelper) [BenchmarkBatchRetrieval](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L719>)

```go
func (b *BenchmarkHelper) BenchmarkBatchRetrieval(batchSize, iterations int) (time.Duration, error)
```

<a name="BenchmarkHelper.BenchmarkRetrieval"></a>
### func (*BenchmarkHelper) [BenchmarkRetrieval](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L704>)

```go
func (b *BenchmarkHelper) BenchmarkRetrieval(iterations int) (time.Duration, error)
```

<a name="ConcurrentTestRunner"></a>
## type [ConcurrentTestRunner](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L390-L394>)

ConcurrentTestRunner runs retriever tests concurrently for performance testing.

```go
type ConcurrentTestRunner struct {
    NumGoroutines int
    TestDuration  time.Duration
    // contains filtered or unexported fields
}
```

<a name="NewConcurrentTestRunner"></a>
### func [NewConcurrentTestRunner](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L396>)

```go
func NewConcurrentTestRunner(numGoroutines int, duration time.Duration, testFunc func() error) *ConcurrentTestRunner
```

<a name="ConcurrentTestRunner.Run"></a>
### func (*ConcurrentTestRunner) [Run](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L404>)

```go
func (r *ConcurrentTestRunner) Run() error
```

<a name="Config"></a>
## type [Config](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L11-L19>)

Config holds the configuration for retrievers.

```go
type Config struct {
    VectorStoreConfig VectorStoreConfig `mapstructure:"vector_store" yaml:"vector_store"`
    DefaultK          int               `mapstructure:"default_k" yaml:"default_k" env:"RETRIEVERS_DEFAULT_K" default:"4" validate:"min=1,max=100"`
    MaxRetries        int               `mapstructure:"max_retries" yaml:"max_retries" env:"RETRIEVERS_MAX_RETRIES" default:"3" validate:"min=0,max=10"`
    Timeout           time.Duration     `mapstructure:"timeout" yaml:"timeout" env:"RETRIEVERS_TIMEOUT" default:"30s" validate:"min=1s,max=5m"`
    ScoreThreshold    float32           `mapstructure:"score_threshold" yaml:"score_threshold" env:"RETRIEVERS_SCORE_THRESHOLD" default:"0.0" validate:"min=0,max=1"`
    EnableTracing     bool              `mapstructure:"enable_tracing" yaml:"enable_tracing" env:"RETRIEVERS_ENABLE_TRACING" default:"true"`
    EnableMetrics     bool              `mapstructure:"enable_metrics" yaml:"enable_metrics" env:"RETRIEVERS_ENABLE_METRICS" default:"true"`
}
```

<a name="DefaultConfig"></a>
### func [DefaultConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L69>)

```go
func DefaultConfig() Config
```

DefaultConfig returns a default configuration for retrievers.

<a name="Config.ApplyDefaults"></a>
### func (*Config) [ApplyDefaults](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L87>)

```go
func (c *Config) ApplyDefaults()
```

ApplyDefaults applies default values to unset fields in the configuration.

<a name="Config.Validate"></a>
### func (*Config) [Validate](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L110>)

```go
func (c *Config) Validate() error
```

Validate validates the configuration.

<a name="DocumentScore"></a>
## type [DocumentScore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L685-L689>)

DocumentScore represents a document with its relevance score.

```go
type DocumentScore struct {
    Document schema.Document
    Score    float32
    Rank     int
}
```

<a name="RankDocuments"></a>
### func [RankDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L659>)

```go
func RankDocuments(query string, documents []schema.Document) []DocumentScore
```

RankDocuments ranks documents by relevance score.

<a name="IntegrationTestHelper"></a>
## type [IntegrationTestHelper](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L490-L494>)

IntegrationTestHelper provides utilities for integration testing.

```go
type IntegrationTestHelper struct {
    // contains filtered or unexported fields
}
```

<a name="NewIntegrationTestHelper"></a>
### func [NewIntegrationTestHelper](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L496>)

```go
func NewIntegrationTestHelper() *IntegrationTestHelper
```

<a name="IntegrationTestHelper.AddEmbedder"></a>
### func (*IntegrationTestHelper) [AddEmbedder](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L512>)

```go
func (h *IntegrationTestHelper) AddEmbedder(name string, embedder any)
```

<a name="IntegrationTestHelper.AddRetriever"></a>
### func (*IntegrationTestHelper) [AddRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L504>)

```go
func (h *IntegrationTestHelper) AddRetriever(name string, retriever *AdvancedMockRetriever)
```

<a name="IntegrationTestHelper.AddVectorStore"></a>
### func (*IntegrationTestHelper) [AddVectorStore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L508>)

```go
func (h *IntegrationTestHelper) AddVectorStore(name string, store any)
```

<a name="IntegrationTestHelper.GetEmbedder"></a>
### func (*IntegrationTestHelper) [GetEmbedder](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L524>)

```go
func (h *IntegrationTestHelper) GetEmbedder(name string) any
```

<a name="IntegrationTestHelper.GetRetriever"></a>
### func (*IntegrationTestHelper) [GetRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L516>)

```go
func (h *IntegrationTestHelper) GetRetriever(name string) *AdvancedMockRetriever
```

<a name="IntegrationTestHelper.GetVectorStore"></a>
### func (*IntegrationTestHelper) [GetVectorStore](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L520>)

```go
func (h *IntegrationTestHelper) GetVectorStore(name string) any
```

<a name="IntegrationTestHelper.Reset"></a>
### func (*IntegrationTestHelper) [Reset](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L528>)

```go
func (h *IntegrationTestHelper) Reset()
```

<a name="Metrics"></a>
## type [Metrics](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L16-L37>)

Metrics holds the metrics for retriever operations.

```go
type Metrics struct {
    // contains filtered or unexported fields
}
```

<a name="GetMetrics"></a>
### func [GetMetrics](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L236>)

```go
func GetMetrics() *Metrics
```

GetMetrics returns the global metrics instance. This follows the standard pattern used across all Beluga AI packages.

<a name="NewMetrics"></a>
### func [NewMetrics](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L40>)

```go
func NewMetrics(meter metric.Meter, tracer trace.Tracer) (*Metrics, error)
```

NewMetrics creates a new Metrics instance with registered metrics.

<a name="Metrics.RecordBatchOperation"></a>
### func (*Metrics) [RecordBatchOperation](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L195>)

```go
func (m *Metrics) RecordBatchOperation(ctx context.Context, operation string, batchSize int, duration time.Duration)
```

RecordBatchOperation records metrics for batch operations.

<a name="Metrics.RecordEmbeddingDimension"></a>
### func (*Metrics) [RecordEmbeddingDimension](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L204>)

```go
func (m *Metrics) RecordEmbeddingDimension(ctx context.Context, dimension int)
```

RecordEmbeddingDimension records the embedding dimension.

<a name="Metrics.RecordRetrieval"></a>
### func (*Metrics) [RecordRetrieval](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L155>)

```go
func (m *Metrics) RecordRetrieval(ctx context.Context, retrieverType string, duration time.Duration, documentCount int, avgScore float64, err error)
```

RecordRetrieval records metrics for a retrieval operation.

<a name="Metrics.RecordVectorStoreOperation"></a>
### func (*Metrics) [RecordVectorStoreOperation](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/metrics.go#L174>)

```go
func (m *Metrics) RecordVectorStoreOperation(ctx context.Context, operation string, duration time.Duration, documentCount int, err error)
```

RecordVectorStoreOperation records metrics for a vector store operation.

<a name="MockRetrieverOption"></a>
## type [MockRetrieverOption](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L62>)

MockRetrieverOption defines functional options for mock configuration.

```go
type MockRetrieverOption func(*AdvancedMockRetriever)
```

<a name="WithErrorCode"></a>
### func [WithErrorCode](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L110>)

```go
func WithErrorCode(errorCode string) MockRetrieverOption
```

WithErrorCode configures the mock to return a specific error code.

<a name="WithErrorType"></a>
### func [WithErrorType](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L118>)

```go
func WithErrorType(err error) MockRetrieverOption
```

WithErrorType configures the mock to return a specific error type.

<a name="WithMockDefaultK"></a>
### func [WithMockDefaultK](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L96>)

```go
func WithMockDefaultK(k int) MockRetrieverOption
```

WithMockDefaultK sets the default number of documents to return.

<a name="WithMockDelay"></a>
### func [WithMockDelay](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L81>)

```go
func WithMockDelay(delay time.Duration) MockRetrieverOption
```

WithMockDelay adds artificial delay to mock operations.

<a name="WithMockDocuments"></a>
### func [WithMockDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L73>)

```go
func WithMockDocuments(documents []schema.Document) MockRetrieverOption
```

WithMockDocuments sets the documents to return from searches.

<a name="WithMockError"></a>
### func [WithMockError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L65>)

```go
func WithMockError(shouldError bool, err error) MockRetrieverOption
```

WithMockError configures the mock to return errors.

<a name="WithMockScores"></a>
### func [WithMockScores](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L88>)

```go
func WithMockScores(scores []float32) MockRetrieverOption
```

WithMockScores sets predefined similarity scores.

<a name="WithScoreThreshold"></a>
### func [WithScoreThreshold](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L103>)

```go
func WithScoreThreshold(threshold float32) MockRetrieverOption
```

WithScoreThreshold sets the minimum similarity score threshold.

<a name="MultiQueryRetriever"></a>
## type [MultiQueryRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L22-L31>)

MultiQueryRetriever implements the core.Retriever interface by generating multiple query variations using an LLM and then retrieving documents for each. This approach helps improve retrieval by considering different phrasings and perspectives.

```go
type MultiQueryRetriever struct {
    // contains filtered or unexported fields
}
```

<a name="NewMultiQueryRetriever"></a>
### func [NewMultiQueryRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L46>)

```go
func NewMultiQueryRetriever(opts *MultiQueryRetrieverOptions) (*MultiQueryRetriever, error)
```

NewMultiQueryRetriever creates a new MultiQueryRetriever.

<a name="MultiQueryRetriever.Batch"></a>
### func (*MultiQueryRetriever) [Batch](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L288>)

```go
func (m *MultiQueryRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)
```

Batch implements the core.Runnable interface.

<a name="MultiQueryRetriever.CheckHealth"></a>
### func (*MultiQueryRetriever) [CheckHealth](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L310>)

```go
func (m *MultiQueryRetriever) CheckHealth(ctx context.Context) error
```

CheckHealth implements the core.HealthChecker interface.

<a name="MultiQueryRetriever.GetRelevantDocuments"></a>
### func (*MultiQueryRetriever) [GetRelevantDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L84>)

```go
func (m *MultiQueryRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)
```

GetRelevantDocuments retrieves documents by generating multiple query variations and combining results from all variations.

<a name="MultiQueryRetriever.Invoke"></a>
### func (*MultiQueryRetriever) [Invoke](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L278>)

```go
func (m *MultiQueryRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)
```

Invoke implements the core.Runnable interface.

<a name="MultiQueryRetriever.Stream"></a>
### func (*MultiQueryRetriever) [Stream](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L304>)

```go
func (m *MultiQueryRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)
```

Stream implements the core.Runnable interface. Streaming is not typically applicable to retrievers, so it returns an error.

<a name="MultiQueryRetrieverOptions"></a>
## type [MultiQueryRetrieverOptions](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/multiquery.go#L34-L43>)

MultiQueryRetrieverOptions holds configuration for MultiQueryRetriever.

```go
type MultiQueryRetrieverOptions struct {
    Retriever     core.Retriever
    LLM           iface.ChatModel
    NumQueries    int
    Tracer        trace.Tracer
    Logger        *slog.Logger
    Metrics       *Metrics
    EnableTracing bool
    EnableMetrics bool
}
```

<a name="Option"></a>
## type [Option](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L49>)

Option is a functional option for configuring retrievers.

```go
type Option func(*RetrieverOptions)
```

<a name="WithDefaultK"></a>
### func [WithDefaultK](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L81>)

```go
func WithDefaultK(k int) Option
```

WithDefaultK sets the default number of documents to retrieve. This is used when GetRelevantDocuments is called without specifying k.

Parameters:

- k: Number of documents to retrieve by default

Returns:

- Option: Configuration option function

Example:

```
retriever, _ := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithDefaultK(10),
)
```

Example usage can be found in examples/rag/simple/main.go

<a name="WithLogger"></a>
### func [WithLogger](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L176>)

```go
func WithLogger(logger *slog.Logger) Option
```

WithLogger sets a custom logger.

<a name="WithMaxRetries"></a>
### func [WithMaxRetries](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L103>)

```go
func WithMaxRetries(retries int) Option
```

WithMaxRetries sets the maximum number of retries for failed operations. Retries are attempted with exponential backoff.

Parameters:

- retries: Maximum number of retry attempts

Returns:

- Option: Configuration option function

Example:

```
retriever, _ := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithMaxRetries(3),
)
```

Example usage can be found in examples/rag/simple/main.go

<a name="WithMeter"></a>
### func [WithMeter](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L190>)

```go
func WithMeter(meter metric.Meter) Option
```

WithMeter sets a custom metrics meter.

<a name="WithMetrics"></a>
### func [WithMetrics](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L169>)

```go
func WithMetrics(enabled bool) Option
```

WithMetrics enables or disables metrics collection. When enabled, operation metrics are recorded using OpenTelemetry.

Parameters:

- enabled: Whether to enable metrics

Returns:

- Option: Configuration option function

Example:

```
retriever, _ := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithMetrics(true),
)
```

Example usage can be found in examples/rag/simple/main.go

<a name="WithTimeout"></a>
### func [WithTimeout](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L125>)

```go
func WithTimeout(timeout time.Duration) Option
```

WithTimeout sets the timeout for operations. Operations that exceed this timeout will be cancelled.

Parameters:

- timeout: Maximum duration for operations

Returns:

- Option: Configuration option function

Example:

```
retriever, _ := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithTimeout(30*time.Second),
)
```

Example usage can be found in examples/rag/simple/main.go

<a name="WithTracer"></a>
### func [WithTracer](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L183>)

```go
func WithTracer(tracer trace.Tracer) Option
```

WithTracer sets a custom tracer.

<a name="WithTracing"></a>
### func [WithTracing](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L147>)

```go
func WithTracing(enabled bool) Option
```

WithTracing enables or disables tracing. When enabled, operations are traced using OpenTelemetry.

Parameters:

- enabled: Whether to enable tracing

Returns:

- Option: Configuration option function

Example:

```
retriever, _ := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithTracing(true),
)
```

Example usage can be found in examples/rag/simple/main.go

<a name="QueryDocumentPair"></a>
## type [QueryDocumentPair](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L599-L604>)

QueryDocumentPair represents a query and its expected relevant document.

```go
type QueryDocumentPair struct {
    Query            string
    ExpectedDoc      schema.Document
    ShouldBeRelevant bool
    MinScore         float32
}
```

<a name="Retriever"></a>
## type [Retriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L44-L46>)

Retriever represents a component that can retrieve relevant documents for a given query.

```go
type Retriever interface {
    core.Retriever
}
```

<a name="RetrieverError"></a>
## type [RetrieverError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L23-L28>)

RetrieverError represents an error that occurred during retrieval operations.

```go
type RetrieverError struct {
    Op      string // operation that failed
    Err     error  // underlying error
    Code    string // error code for programmatic handling
    Message string // human-readable message
}
```

<a name="NewRetrieverError"></a>
### func [NewRetrieverError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L42>)

```go
func NewRetrieverError(op string, err error, code string) *RetrieverError
```

NewRetrieverError creates a new RetrieverError.

<a name="NewRetrieverErrorWithMessage"></a>
### func [NewRetrieverErrorWithMessage](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L51>)

```go
func NewRetrieverErrorWithMessage(op string, err error, code, message string) *RetrieverError
```

NewRetrieverErrorWithMessage creates a new RetrieverError with a custom message.

<a name="RetrieverError.Error"></a>
### func (*RetrieverError) [Error](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L30>)

```go
func (e *RetrieverError) Error() string
```

<a name="RetrieverError.Unwrap"></a>
### func (*RetrieverError) [Unwrap](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L37>)

```go
func (e *RetrieverError) Unwrap() error
```

<a name="RetrieverOptions"></a>
## type [RetrieverOptions](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L52-L63>)

RetrieverOptions holds configuration options for retrievers.

```go
type RetrieverOptions struct {
    Tracer         trace.Tracer
    Meter          metric.Meter
    Logger         *slog.Logger
    Metrics        *Metrics
    DefaultK       int
    MaxRetries     int
    Timeout        time.Duration
    ScoreThreshold float32
    EnableTracing  bool
    EnableMetrics  bool
}
```

<a name="CreateTestRetrieverConfig"></a>
### func [CreateTestRetrieverConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L327>)

```go
func CreateTestRetrieverConfig() RetrieverOptions
```

CreateTestRetrieverConfig creates a test retriever configuration.

<a name="RetrieverScenarioRunner"></a>
## type [RetrieverScenarioRunner](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L536-L538>)

RetrieverScenarioRunner runs common retriever scenarios.

```go
type RetrieverScenarioRunner struct {
    // contains filtered or unexported fields
}
```

<a name="NewRetrieverScenarioRunner"></a>
### func [NewRetrieverScenarioRunner](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L540>)

```go
func NewRetrieverScenarioRunner(retriever core.Retriever) *RetrieverScenarioRunner
```

<a name="RetrieverScenarioRunner.RunMultiQueryScenario"></a>
### func (*RetrieverScenarioRunner) [RunMultiQueryScenario](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L546>)

```go
func (r *RetrieverScenarioRunner) RunMultiQueryScenario(ctx context.Context, queries []string) ([][]schema.Document, error)
```

<a name="RetrieverScenarioRunner.RunRelevanceTestScenario"></a>
### func (*RetrieverScenarioRunner) [RunRelevanceTestScenario](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/test_utils.go#L560>)

```go
func (r *RetrieverScenarioRunner) RunRelevanceTestScenario(ctx context.Context, queryDocPairs []QueryDocumentPair) error
```

<a name="RetrieversMockcomponent"></a>
## type [RetrieversMockcomponent](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers_mock.go#L8-L10>)

RetrieversMockcomponent is a mock implementation of Interface.

```go
type RetrieversMockcomponent struct {
    mock.Mock
}
```

<a name="NewRetrieversMockcomponent"></a>
### func [NewRetrieversMockcomponent](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers_mock.go#L13>)

```go
func NewRetrieversMockcomponent() *RetrieversMockcomponent
```

NewRetrieversMockcomponent creates a new RetrieversMockcomponent.

<a name="TimeoutError"></a>
## type [TimeoutError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L72-L76>)

TimeoutError represents a timeout error.

```go
type TimeoutError struct {
    Err     error
    Op      string
    Timeout time.Duration
}
```

<a name="NewTimeoutError"></a>
### func [NewTimeoutError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L87>)

```go
func NewTimeoutError(op string, timeout time.Duration, err error) *TimeoutError
```

NewTimeoutError creates a new TimeoutError.

<a name="TimeoutError.Error"></a>
### func (*TimeoutError) [Error](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L78>)

```go
func (e *TimeoutError) Error() string
```

<a name="TimeoutError.Unwrap"></a>
### func (*TimeoutError) [Unwrap](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L82>)

```go
func (e *TimeoutError) Unwrap() error
```

<a name="ValidationError"></a>
## type [ValidationError](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L61-L65>)

ValidationError represents a configuration validation error.

```go
type ValidationError struct {
    Field string // field that failed validation
    Value any    // value that failed validation
    Msg   string // validation error message
}
```

<a name="ValidationError.Error"></a>
### func (*ValidationError) [Error](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/errors.go#L67>)

```go
func (e *ValidationError) Error() string
```

<a name="VectorStoreConfig"></a>
## type [VectorStoreConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L22-L30>)

VectorStoreConfig holds vector store specific configuration.

```go
type VectorStoreConfig struct {
    // Common vector store settings
    MaxBatchSize int `mapstructure:"max_batch_size" yaml:"max_batch_size" env:"VECTOR_STORE_MAX_BATCH_SIZE" default:"100" validate:"min=1,max=1000"`

    // Search optimization settings
    EnableMMR          bool    `mapstructure:"enable_mmr" yaml:"enable_mmr" env:"VECTOR_STORE_ENABLE_MMR" default:"false"`
    MMRLambda          float32 `mapstructure:"mmr_lambda" yaml:"mmr_lambda" env:"VECTOR_STORE_MMR_LAMBDA" default:"0.5" validate:"min=0,max=1"`
    DiversityThreshold float32 `mapstructure:"diversity_threshold" yaml:"diversity_threshold" env:"VECTOR_STORE_DIVERSITY_THRESHOLD" default:"0.7" validate:"min=0,max=1"`
}
```

<a name="VectorStoreConfig.ApplyDefaults"></a>
### func (*VectorStoreConfig) [ApplyDefaults](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L102>)

```go
func (c *VectorStoreConfig) ApplyDefaults()
```

ApplyDefaults applies default values to unset fields in VectorStoreConfig.

<a name="VectorStoreConfig.Validate"></a>
### func (*VectorStoreConfig) [Validate](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L33>)

```go
func (c *VectorStoreConfig) Validate() error
```

Validate validates the VectorStoreConfig.

<a name="VectorStoreRetriever"></a>
## type [VectorStoreRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L21-L32>)

VectorStoreRetriever implements the core.Retriever interface using an underlying vectorstores.VectorStore. It provides configurable retrieval with support for tracing, metrics, and structured logging.

```go
type VectorStoreRetriever struct {
    // contains filtered or unexported fields
}
```

<a name="NewVectorStoreRetriever"></a>
### func [NewVectorStoreRetriever](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L221>)

```go
func NewVectorStoreRetriever(vectorStore vectorstores.VectorStore, options ...Option) (*VectorStoreRetriever, error)
```

NewVectorStoreRetriever creates a new VectorStoreRetriever with the given vector store and options. The retriever uses the vector store to perform similarity search and retrieve relevant documents.

Parameters:

- vectorStore: Vector store instance to use for retrieval
- options: Optional configuration functions (WithDefaultK, WithScoreThreshold, etc.)

Returns:

- *VectorStoreRetriever: A new retriever instance
- error: Configuration validation errors

Example:

```
store, _ := vectorstores.NewInMemoryStore(ctx)
retriever, err := retrievers.NewVectorStoreRetriever(store,
    retrievers.WithDefaultK(5),
    retrievers.WithScoreThreshold(0.7),
    retrievers.WithTimeout(30*time.Second),
)
if err != nil {
    log.Fatal(err)
}
docs, err := retriever.GetRelevantDocuments(ctx, "What is AI?")
```

Example usage can be found in examples/rag/simple/main.go

<a name="NewVectorStoreRetrieverFromConfig"></a>
### func [NewVectorStoreRetrieverFromConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/retrievers.go#L268>)

```go
func NewVectorStoreRetrieverFromConfig(vectorStore vectorstores.VectorStore, config VectorStoreRetrieverConfig) (*VectorStoreRetriever, error)
```

NewVectorStoreRetrieverFromConfig creates a VectorStoreRetriever from a configuration struct.

Example:

```
config := retrievers.VectorStoreRetrieverConfig{
    K: 5,
    ScoreThreshold: 0.7,
    Timeout: 30 * time.Second,
}
retriever, err := retrievers.NewVectorStoreRetrieverFromConfig(vectorStore, config)
```

<a name="VectorStoreRetriever.Batch"></a>
### func (*VectorStoreRetriever) [Batch](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L195>)

```go
func (r *VectorStoreRetriever) Batch(ctx context.Context, inputs []any, options ...core.Option) ([]any, error)
```

Batch implements the core.Runnable interface.

<a name="VectorStoreRetriever.CheckHealth"></a>
### func (*VectorStoreRetriever) [CheckHealth](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L218>)

```go
func (r *VectorStoreRetriever) CheckHealth(ctx context.Context) error
```

CheckHealth implements the core.HealthChecker interface. It performs a basic health check by validating the retriever's configuration and dependencies.

<a name="VectorStoreRetriever.GetRelevantDocuments"></a>
### func (*VectorStoreRetriever) [GetRelevantDocuments](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L76>)

```go
func (r *VectorStoreRetriever) GetRelevantDocuments(ctx context.Context, query string) ([]schema.Document, error)
```

GetRelevantDocuments retrieves documents from the vector store based on the query. This method adheres to the core.Retriever interface and uses the retriever's default configuration. For call-specific options, use the Invoke method.

<a name="VectorStoreRetriever.Invoke"></a>
### func (*VectorStoreRetriever) [Invoke](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L184>)

```go
func (r *VectorStoreRetriever) Invoke(ctx context.Context, input any, options ...core.Option) (any, error)
```

Invoke implements the core.Runnable interface.

<a name="VectorStoreRetriever.Stream"></a>
### func (*VectorStoreRetriever) [Stream](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/vectorstore.go#L211>)

```go
func (r *VectorStoreRetriever) Stream(ctx context.Context, input any, options ...core.Option) (<-chan any, error)
```

Stream implements the core.Runnable interface. Streaming is not typically applicable to retrievers, so it returns an error.

<a name="VectorStoreRetrieverConfig"></a>
## type [VectorStoreRetrieverConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L59-L66>)

VectorStoreRetrieverConfig holds configuration specific to VectorStoreRetriever.

```go
type VectorStoreRetrieverConfig struct {
    Embedder       iface.Embedder `mapstructure:"-" yaml:"-"`
    MetadataFilter map[string]any `mapstructure:"metadata_filter" yaml:"metadata_filter"`
    K              int            `mapstructure:"k" yaml:"k" env:"VECTOR_STORE_RETRIEVER_K" default:"4" validate:"min=1,max=100"`
    BatchSize      int            `mapstructure:"batch_size" yaml:"batch_size" env:"VECTOR_STORE_RETRIEVER_BATCH_SIZE" default:"10" validate:"min=1,max=100"`
    Timeout        time.Duration  `mapstructure:"timeout" yaml:"timeout" env:"VECTOR_STORE_RETRIEVER_TIMEOUT" default:"30s" validate:"min=1s,max=5m"`
    ScoreThreshold float32        `mapstructure:"score_threshold" yaml:"score_threshold" env:"VECTOR_STORE_RETRIEVER_SCORE_THRESHOLD" default:"0.0" validate:"min=0,max=1"`
}
```

<a name="DefaultVectorStoreRetrieverConfig"></a>
### func [DefaultVectorStoreRetrieverConfig](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L149>)

```go
func DefaultVectorStoreRetrieverConfig() VectorStoreRetrieverConfig
```

DefaultVectorStoreRetrieverConfig returns a default configuration for VectorStoreRetriever.

<a name="VectorStoreRetrieverConfig.ApplyDefaults"></a>
### func (*VectorStoreRetrieverConfig) [ApplyDefaults](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L159>)

```go
func (c *VectorStoreRetrieverConfig) ApplyDefaults()
```

ApplyDefaults applies default values to unset fields in the configuration.

<a name="VectorStoreRetrieverConfig.Validate"></a>
### func (*VectorStoreRetrieverConfig) [Validate](<https://github.com/lookatitude/beluga-ai/blob/main/pkg/retrievers/config.go#L173>)

```go
func (c *VectorStoreRetrieverConfig) Validate() error
```

Validate validates the VectorStoreRetrieverConfig.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
